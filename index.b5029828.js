let e;const i={pc:`These are my experiences:<br>
  Software Engineering Fellow, Headstarter AI:As a Software Engineering Fellow at Headstarter AI, I am embarking on a dynamic 7-week journey working on diverse projects across various fields. This immersive experience includes hands-on development in cutting-edge technologies, participating in engaging hackathons, and receiving tailored interview preparation to sharpen my skills.<br> 
  Student Ambassador, Viral Fission:In my role as a Student Ambassador at Viral Fission, I organize and host blockchain gaming events to foster community engagement. I create engaging content, including reels and social media posts, to promote products and enhance brand visibility.<br>
   `,"cs-degree":"I have certificationS from META in HTML & CSS, and also Version Control.","sofa-table":"Hello!, I'm Aarcha U, a B.E. student specializing in Artificial Intelligence & Machine Learning at Impact College of Engineering & Applied Sciences. With experience in web development, blockchain event management, and a passion for technology, I bring a creative and analytical approach to every project. Explore my portfolio to see my work in programming and design, and feel free to connect with me for collaboration!",tv:' Check out my LinedIn profile:<a href="https://www.linkedin.com/in/aarcha-u" target="_blank">LinkedIn</a>.',bed:"This where I sleep. Great ideas comes when I'm lying on my bed. When an idea strikes, I often have to write it down or else I won't be able to sleep because my mental energy is consumed by it.",resume:`This is my desk and on it is my Github Profile: <a href="https://github.com/aarch34" target="_blank">Github</a>,
  Contact me at aarcha.u@yahoo.com if you have any interesting job opportunities!`,projects:`Some projects I've Done:<br>
  I developed a user-friendly website for Bibha, The Event Company, focusing on responsive design and multimedia integration to enhance user engagement.<br>
   Additionally, I created an e-commerce web app for a college project,showcasing a jewellery store using Django and MySQL, featuring a secure user authentication system, a dynamic product catalog, and a comprehensive admin dashboard. These projects showcase my skills in web development and my commitment to delivering functional and visually appealing digital solutions.`,library:`These are my skills:<br>Programming Languages: Python, HTML5, CSS, C.
<br>Web Development: Django, Kaboom.js, Responsive Design, Frontend Development.
<br>Database Management: MySQL,MongoDB.
<br>Version Control: Git, GitHub.`,exit:"If you want to exit Aarcha U's portfolio, just close the tab."};var r=Object.defineProperty,n=(e,i)=>r(e,"name",{value:i,configurable:!0}),o=(()=>{for(var e=new Uint8Array(128),i=0;i<64;i++)e[i<26?i+65:i<52?i+71:i<62?i-4:4*i-205]=i;return i=>{for(var r=i.length,n=new Uint8Array((r-("="==i[r-1])-("="==i[r-2]))*3/4|0),o=0,l=0;o<r;){var u=e[i.charCodeAt(o++)],c=e[i.charCodeAt(o++)],f=e[i.charCodeAt(o++)],g=e[i.charCodeAt(o++)];n[l++]=u<<2|c>>4,n[l++]=c<<4|f>>2,n[l++]=f<<6|g}return n}})();function l(e){return e*Math.PI/180}function u(e){return 180*e/Math.PI}function c(e,i,r){return i>r?c(e,r,i):Math.min(Math.max(e,i),r)}function f(e,i,r){if("number"==typeof e&&"number"==typeof i)return e+(i-e)*r;if(e instanceof w&&i instanceof w||e instanceof y&&i instanceof y)return e.lerp(i,r);throw Error(`Bad value for lerp(): ${e}, ${i}. Only number, Vec2 and Color is supported.`)}function g(e,i,r,n,o){return n+(e-i)/(r-i)*(o-n)}function m(e,i,r,n,o){return c(g(e,i,r,n,o),n,o)}n(l,"deg2rad"),n(u,"rad2deg"),n(c,"clamp"),n(f,"lerp"),n(g,"map"),n(m,"mapc");var w=class e{static{n(this,"Vec2")}x=0;y=0;constructor(e=0,i=e){this.x=e,this.y=i}static fromAngle(i){let r=l(i);return new e(Math.cos(r),Math.sin(r))}static LEFT=new e(-1,0);static RIGHT=new e(1,0);static UP=new e(0,-1);static DOWN=new e(0,1);clone(){return new e(this.x,this.y)}add(...i){let r=A(...i);return new e(this.x+r.x,this.y+r.y)}sub(...i){let r=A(...i);return new e(this.x-r.x,this.y-r.y)}scale(...i){let r=A(...i);return new e(this.x*r.x,this.y*r.y)}dist(...e){let i=A(...e);return this.sub(i).len()}sdist(...e){let i=A(...e);return this.sub(i).slen()}len(){return Math.sqrt(this.dot(this))}slen(){return this.dot(this)}unit(){let i=this.len();return 0===i?new e(0):this.scale(1/i)}normal(){return new e(this.y,-this.x)}reflect(e){return this.sub(e.scale(2*this.dot(e)))}project(e){return e.scale(e.dot(this)/e.len())}reject(e){return this.sub(this.project(e))}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}angle(...e){let i=A(...e);return u(Math.atan2(this.y-i.y,this.x-i.x))}angleBetween(...e){let i=A(...e);return u(Math.atan2(this.cross(i),this.dot(i)))}lerp(i,r){return new e(f(this.x,i.x,r),f(this.y,i.y,r))}slerp(e,i){let r=this.dot(e),n=this.cross(e),o=Math.atan2(n,r);return this.scale(Math.sin((1-i)*o)).add(e.scale(Math.sin(i*o))).scale(1/n)}isZero(){return 0===this.x&&0===this.y}toFixed(i){return new e(Number(this.x.toFixed(i)),Number(this.y.toFixed(i)))}transform(e){return e.multVec2(this)}eq(e){return this.x===e.x&&this.y===e.y}bbox(){return new Q(this,0,0)}toString(){return`vec2(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}};function A(...e){if(1===e.length){if(e[0]instanceof w)return new w(e[0].x,e[0].y);if(Array.isArray(e[0])&&2===e[0].length)return new w(...e[0])}return new w(...e)}n(A,"vec2");var y=class e{static{n(this,"Color")}r=255;g=255;b=255;constructor(e,i,r){this.r=c(e,0,255),this.g=c(i,0,255),this.b=c(r,0,255)}static fromArray(i){return new e(i[0],i[1],i[2])}static fromHex(i){if("number"==typeof i)return new e(i>>16&255,i>>8&255,i>>0&255);if("string"==typeof i){let r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i);return new e(parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16))}throw Error("Invalid hex color format")}static fromHSL(i,r,o){if(0==r)return new e(255*o,255*o,255*o);let l=n((e,i,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(i-e)*6*r:r<.5?i:r<2/3?e+(i-e)*(2/3-r)*6:e),"hue2rgb"),u=o<.5?o*(1+r):o+r-o*r,c=2*o-u;return new e(Math.round(255*l(c,u,i+1/3)),Math.round(255*l(c,u,i)),Math.round(255*l(c,u,i-1/3)))}static RED=new e(255,0,0);static GREEN=new e(0,255,0);static BLUE=new e(0,0,255);static YELLOW=new e(255,255,0);static MAGENTA=new e(255,0,255);static CYAN=new e(0,255,255);static WHITE=new e(255,255,255);static BLACK=new e(0,0,0);clone(){return new e(this.r,this.g,this.b)}lighten(i){return new e(this.r+i,this.g+i,this.b+i)}darken(e){return this.lighten(-e)}invert(){return new e(255-this.r,255-this.g,255-this.b)}mult(i){return new e(this.r*i.r/255,this.g*i.g/255,this.b*i.b/255)}lerp(i,r){return new e(f(this.r,i.r,r),f(this.g,i.g,r),f(this.b,i.b,r))}toHSL(){let e=this.r/255,i=this.g/255,r=this.b/255,n=Math.max(e,i,r),o=Math.min(e,i,r),l=(n+o)/2,u=l,c=l;if(n==o)l=u=0;else{let f=n-o;switch(u=c>.5?f/(2-n-o):f/(n+o),n){case e:l=(i-r)/f+(i<r?6:0);break;case i:l=(r-e)/f+2;break;case r:l=(e-i)/f+4}l/=6}return[l,u,c]}eq(e){return this.r===e.r&&this.g===e.g&&this.b===e.b}toString(){return`rgb(${this.r}, ${this.g}, ${this.b})`}toHex(){return"#"+(16777216+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}};function v(...e){if(0===e.length)return new y(255,255,255);if(1===e.length){if(e[0]instanceof y)return e[0].clone();if("string"==typeof e[0])return y.fromHex(e[0]);if(Array.isArray(e[0])&&3===e[0].length)return y.fromArray(e[0])}return new y(...e)}n(v,"rgb");var V=n((e,i,r)=>y.fromHSL(e,i,r),"hsl2rgb"),x=class e{static{n(this,"Quad")}x=0;y=0;w=1;h=1;constructor(e,i,r,n){this.x=e,this.y=i,this.w=r,this.h=n}scale(i){return new e(this.x+this.w*i.x,this.y+this.h*i.y,this.w*i.w,this.h*i.h)}pos(){return new w(this.x,this.y)}clone(){return new e(this.x,this.y,this.w,this.h)}eq(e){return this.x===e.x&&this.y===e.y&&this.w===e.w&&this.h===e.h}toString(){return`quad(${this.x}, ${this.y}, ${this.w}, ${this.h})`}};function E(e,i,r,n){return new x(e,i,r,n)}n(E,"quad");var S=class e{static{n(this,"Mat4")}m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];constructor(e){e&&(this.m=e)}static translate(i){return new e([1,0,0,0,0,1,0,0,0,0,1,0,i.x,i.y,0,1])}static scale(i){return new e([i.x,0,0,0,0,i.y,0,0,0,0,1,0,0,0,0,1])}static rotateX(i){let r=Math.cos(i=l(-i)),n=Math.sin(i);return new e([1,0,0,0,0,r,-n,0,0,n,r,0,0,0,0,1])}static rotateY(i){let r=Math.cos(i=l(-i)),n=Math.sin(i);return new e([r,0,n,0,0,1,0,0,-n,0,r,0,0,0,0,1])}static rotateZ(i){let r=Math.cos(i=l(-i)),n=Math.sin(i);return new e([r,-n,0,0,n,r,0,0,0,0,1,0,0,0,0,1])}translate(e){return this.m[12]+=this.m[0]*e.x+this.m[4]*e.y,this.m[13]+=this.m[1]*e.x+this.m[5]*e.y,this.m[14]+=this.m[2]*e.x+this.m[6]*e.y,this.m[15]+=this.m[3]*e.x+this.m[7]*e.y,this}scale(e){return this.m[0]*=e.x,this.m[4]*=e.y,this.m[1]*=e.x,this.m[5]*=e.y,this.m[2]*=e.x,this.m[6]*=e.y,this.m[3]*=e.x,this.m[7]*=e.y,this}rotate(e){let i=Math.cos(e=l(-e)),r=Math.sin(e),n=this.m[0],o=this.m[1],u=this.m[4],c=this.m[5];return this.m[0]=n*i+o*r,this.m[1]=-n*r+o*i,this.m[4]=u*i+c*r,this.m[5]=-u*r+c*i,this}mult(i){let r=[];for(let e=0;e<4;e++)for(let n=0;n<4;n++)r[4*e+n]=this.m[0+n]*i.m[4*e+0]+this.m[4+n]*i.m[4*e+1]+this.m[8+n]*i.m[4*e+2]+this.m[12+n]*i.m[4*e+3];return new e(r)}multVec2(e){return new w(e.x*this.m[0]+e.y*this.m[4]+this.m[12],e.x*this.m[1]+e.y*this.m[5]+this.m[13])}getTranslation(){return new w(this.m[12],this.m[13])}getScale(){if(0!=this.m[0]||0!=this.m[1]){let e=this.m[0]*this.m[5]-this.m[1]*this.m[4],i=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return new w(i,e/i)}if(0==this.m[4]&&0==this.m[5])return new w(0,0);{let e=this.m[0]*this.m[5]-this.m[1]*this.m[4],i=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return new w(e/i,i)}}getRotation(){if(0!=this.m[0]||0!=this.m[1]){let e=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return u(this.m[1]>0?Math.acos(this.m[0]/e):-Math.acos(this.m[0]/e))}if(0==this.m[4]&&0==this.m[5])return 0;{let e=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return u(Math.PI/2-(this.m[5]>0?Math.acos(-this.m[4]/e):-Math.acos(this.m[4]/e)))}}getSkew(){if(0!=this.m[0]||0!=this.m[1]){let e=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return new w(Math.atan(this.m[0]*this.m[4]+this.m[1]*this.m[5])/(e*e),0)}if(0==this.m[4]&&0==this.m[5])return new w(0,0);{let e=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return new w(0,Math.atan(this.m[0]*this.m[4]+this.m[1]*this.m[5])/(e*e))}}invert(){let i=[],r=this.m[10]*this.m[15]-this.m[14]*this.m[11],n=this.m[9]*this.m[15]-this.m[13]*this.m[11],o=this.m[9]*this.m[14]-this.m[13]*this.m[10],l=this.m[8]*this.m[15]-this.m[12]*this.m[11],u=this.m[8]*this.m[14]-this.m[12]*this.m[10],c=this.m[8]*this.m[13]-this.m[12]*this.m[9],f=this.m[6]*this.m[15]-this.m[14]*this.m[7],g=this.m[5]*this.m[15]-this.m[13]*this.m[7],m=this.m[5]*this.m[14]-this.m[13]*this.m[6],w=this.m[4]*this.m[15]-this.m[12]*this.m[7],A=this.m[4]*this.m[14]-this.m[12]*this.m[6],y=this.m[5]*this.m[15]-this.m[13]*this.m[7],v=this.m[4]*this.m[13]-this.m[12]*this.m[5],V=this.m[6]*this.m[11]-this.m[10]*this.m[7],x=this.m[5]*this.m[11]-this.m[9]*this.m[7],E=this.m[5]*this.m[10]-this.m[9]*this.m[6],S=this.m[4]*this.m[11]-this.m[8]*this.m[7],R=this.m[4]*this.m[10]-this.m[8]*this.m[6],T=this.m[4]*this.m[9]-this.m[8]*this.m[5];i[0]=this.m[5]*r-this.m[6]*n+this.m[7]*o,i[4]=-(this.m[4]*r-this.m[6]*l+this.m[7]*u),i[8]=this.m[4]*n-this.m[5]*l+this.m[7]*c,i[12]=-(this.m[4]*o-this.m[5]*u+this.m[6]*c),i[1]=-(this.m[1]*r-this.m[2]*n+this.m[3]*o),i[5]=this.m[0]*r-this.m[2]*l+this.m[3]*u,i[9]=-(this.m[0]*n-this.m[1]*l+this.m[3]*c),i[13]=this.m[0]*o-this.m[1]*u+this.m[2]*c,i[2]=this.m[1]*f-this.m[2]*g+this.m[3]*m,i[6]=-(this.m[0]*f-this.m[2]*w+this.m[3]*A),i[10]=this.m[0]*y-this.m[1]*w+this.m[3]*v,i[14]=-(this.m[0]*m-this.m[1]*A+this.m[2]*v),i[3]=-(this.m[1]*V-this.m[2]*x+this.m[3]*E),i[7]=this.m[0]*V-this.m[2]*S+this.m[3]*R,i[11]=-(this.m[0]*x-this.m[1]*S+this.m[3]*T),i[15]=this.m[0]*E-this.m[1]*R+this.m[2]*T;let P=this.m[0]*i[0]+this.m[1]*i[4]+this.m[2]*i[8]+this.m[3]*i[12];for(let e=0;e<4;e++)for(let r=0;r<4;r++)i[4*e+r]*=1/P;return new e(i)}clone(){return new e([...this.m])}toString(){return this.m.toString()}};function R(e,i,r,n=e=>-Math.cos(e)){return e+(n(r)+1)/2*(i-e)}n(R,"wave");var T=class{static{n(this,"RNG")}seed;constructor(e){this.seed=e}gen(){return this.seed=(1103515245*this.seed+12345)%2147483648,this.seed/2147483648}genNumber(e,i){return e+this.gen()*(i-e)}genVec2(e,i){return new w(this.genNumber(e.x,i.x),this.genNumber(e.y,i.y))}genColor(e,i){return new y(this.genNumber(e.r,i.r),this.genNumber(e.g,i.g),this.genNumber(e.b,i.b))}genAny(...e){if(0===e.length)return this.gen();if(1===e.length){if("number"==typeof e[0])return this.genNumber(0,e[0]);if(e[0]instanceof w)return this.genVec2(A(0,0),e[0]);if(e[0]instanceof y)return this.genColor(v(0,0,0),e[0])}else if(2===e.length){if("number"==typeof e[0]&&"number"==typeof e[1])return this.genNumber(e[0],e[1]);if(e[0]instanceof w&&e[1]instanceof w)return this.genVec2(e[0],e[1]);if(e[0]instanceof y&&e[1]instanceof y)return this.genColor(e[0],e[1])}}},P=new T(Date.now());function B(e){return null!=e&&(P.seed=e),P.seed}function k(...e){return P.genAny(...e)}function F(...e){return Math.floor(k(...e))}function I(e){return k()<=e}function D(e){return e[F(e.length)]}function C(e,i){return e.pos.x+e.width>i.pos.x&&e.pos.x<i.pos.x+i.width&&e.pos.y+e.height>i.pos.y&&e.pos.y<i.pos.y+i.height}function U(e,i){if(e.p1.x===e.p2.x&&e.p1.y===e.p2.y||i.p1.x===i.p2.x&&i.p1.y===i.p2.y)return null;let r=(i.p2.y-i.p1.y)*(e.p2.x-e.p1.x)-(i.p2.x-i.p1.x)*(e.p2.y-e.p1.y);if(0===r)return null;let n=((i.p2.x-i.p1.x)*(e.p1.y-i.p1.y)-(i.p2.y-i.p1.y)*(e.p1.x-i.p1.x))/r,o=((e.p2.x-e.p1.x)*(e.p1.y-i.p1.y)-(e.p2.y-e.p1.y)*(e.p1.x-i.p1.x))/r;return n<0||n>1||o<0||o>1?null:n}function N(e,i){let r=U(e,i);return r?A(e.p1.x+r*(e.p2.x-e.p1.x),e.p1.y+r*(e.p2.y-e.p1.y)):null}function L(e,i){if(O(e,i.p1)||O(e,i.p2))return!0;let r=e.points();return!!N(i,new Y(r[0],r[1]))||!!N(i,new Y(r[1],r[2]))||!!N(i,new Y(r[2],r[3]))||!!N(i,new Y(r[3],r[0]))}function O(e,i){return i.x>e.pos.x&&i.x<e.pos.x+e.width&&i.y>e.pos.y&&i.y<e.pos.y+e.height}function G(e,i){let r=i.sub(e.p1),n=e.p2.sub(e.p1);if(Math.abs(r.cross(n))>Number.EPSILON)return!1;let o=r.dot(n)/n.dot(n);return o>=0&&o<=1}function q(e,i){let r=e.p2.sub(e.p1),n=r.dot(r),o=e.p1.sub(i.center),l=2*r.dot(o),u=l*l-4*n*(o.dot(o)-i.radius*i.radius);if(n<=Number.EPSILON||u<0)return!1;if(0==u){let e=-l/(2*n);if(e>=0&&e<=1)return!0}else{let e=(-l+Math.sqrt(u))/(2*n),i=(-l-Math.sqrt(u))/(2*n);if(e>=0&&e<=1||i>=0&&i<=1)return!0}return H(i,e.p1)}function H(e,i){return e.center.sdist(i)<e.radius*e.radius}function K(e,i){let r=i.pts[i.pts.length-1];for(let n of i.pts){if(q(new Y(r,n),e))return!0;r=n}return!!H(e,i.pts[0])||j(i,e.center)}function j(e,i){let r=!1,n=e.pts;for(let e=0,o=n.length-1;e<n.length;o=e++)n[e].y>i.y!=n[o].y>i.y&&i.x<(n[o].x-n[e].x)*(i.y-n[e].y)/(n[o].y-n[e].y)+n[e].x&&(r=!r);return r}n(B,"randSeed"),n(k,"rand"),n(F,"randi"),n(I,"chance"),n(D,"choose"),n(C,"testRectRect"),n(U,"testLineLineT"),n(N,"testLineLine"),n(L,"testRectLine"),n(O,"testRectPoint"),n(G,"testLinePoint"),n(q,"testLineCircle"),n(H,"testCirclePoint"),n(K,"testCirclePolygon"),n(j,"testPolygonPoint");var Y=class e{static{n(this,"Line")}p1;p2;constructor(e,i){this.p1=e.clone(),this.p2=i.clone()}transform(i){return new e(i.multVec2(this.p1),i.multVec2(this.p2))}bbox(){return Q.fromPoints(this.p1,this.p2)}area(){return this.p1.dist(this.p2)}clone(){return new e(this.p1,this.p2)}},Q=class e{static{n(this,"Rect")}pos;width;height;constructor(e,i,r){this.pos=e.clone(),this.width=i,this.height=r}static fromPoints(i,r){return new e(i.clone(),r.x-i.x,r.y-i.y)}center(){return new w(this.pos.x+this.width/2,this.pos.y+this.height/2)}points(){return[this.pos,this.pos.add(this.width,0),this.pos.add(this.width,this.height),this.pos.add(0,this.height)]}transform(e){return new X(this.points().map(i=>e.multVec2(i)))}bbox(){return this.clone()}area(){return this.width*this.height}clone(){return new e(this.pos.clone(),this.width,this.height)}distToPoint(e){return Math.sqrt(this.sdistToPoint(e))}sdistToPoint(e){let i=this.pos,r=this.pos.add(this.width,this.height),n=Math.max(i.x-e.x,0,e.x-r.x),o=Math.max(i.y-e.y,0,e.y-r.y);return n*n+o*o}},z=class e{static{n(this,"Circle")}center;radius;constructor(e,i){this.center=e.clone(),this.radius=i}transform(e){return new J(this.center,this.radius,this.radius).transform(e)}bbox(){return Q.fromPoints(this.center.sub(A(this.radius)),this.center.add(A(this.radius)))}area(){return this.radius*this.radius*Math.PI}clone(){return new e(this.center,this.radius)}},J=class e{static{n(this,"Ellipse")}center;radiusX;radiusY;constructor(e,i,r){this.center=e.clone(),this.radiusX=i,this.radiusY=r}transform(i){return new e(i.multVec2(this.center),i.m[0]*this.radiusX,i.m[5]*this.radiusY)}bbox(){return Q.fromPoints(this.center.sub(A(this.radiusX,this.radiusY)),this.center.add(A(this.radiusX,this.radiusY)))}area(){return this.radiusX*this.radiusY*Math.PI}clone(){return new e(this.center,this.radiusX,this.radiusY)}},X=class e{static{n(this,"Polygon")}pts;constructor(e){if(e.length<3)throw Error("Polygons should have at least 3 vertices");this.pts=e}transform(i){return new e(this.pts.map(e=>i.multVec2(e)))}bbox(){let e=A(Number.MAX_VALUE),i=A(-Number.MAX_VALUE);for(let r of this.pts)e.x=Math.min(e.x,r.x),i.x=Math.max(i.x,r.x),e.y=Math.min(e.y,r.y),i.y=Math.max(i.y,r.y);return Q.fromPoints(e,i)}area(){let e=0,i=this.pts.length;for(let r=0;r<i;r++){let n=this.pts[r],o=this.pts[(r+1)%i];e+=n.x*o.y*.5,e-=o.x*n.y*.5}return Math.abs(e)}clone(){return new e(this.pts.map(e=>e.clone()))}};function W(e,i){let r=Number.MAX_VALUE,n=A(0);for(let o of[e,i])for(let l=0;l<o.pts.length;l++){let u=o.pts[l],c=o.pts[(l+1)%o.pts.length].sub(u).normal().unit(),f=Number.MAX_VALUE,g=-Number.MAX_VALUE;for(let i=0;i<e.pts.length;i++){let r=e.pts[i].dot(c);f=Math.min(f,r),g=Math.max(g,r)}let m=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let e=0;e<i.pts.length;e++){let r=i.pts[e].dot(c);m=Math.min(m,r),w=Math.max(w,r)}let A=Math.min(g,w)-Math.max(f,m);if(A<0)return null;if(A<Math.abs(r)){let e=w-f,i=m-g;r=Math.abs(e)<Math.abs(i)?e:i,n=c.scale(r)}}return n}n(W,"sat");var Z=class extends Map{static{n(this,"Registry")}lastID;constructor(...e){super(...e),this.lastID=0}push(e){let i=this.lastID;return this.set(i,e),this.lastID++,i}pushd(e){let i=this.push(e);return()=>this.delete(i)}},_=class e{static{n(this,"EventController")}paused=!1;cancel;constructor(e){this.cancel=e}static join(i){let r=new e(()=>i.forEach(e=>e.cancel()));return Object.defineProperty(r,"paused",{get:()=>i[0].paused,set:e=>i.forEach(i=>i.paused=e)}),r.paused=!1,r}},$=class{static{n(this,"Event")}handlers=new Z;add(e){let i=new _(this.handlers.pushd((...r)=>{i.paused||e(...r)}));return i}addOnce(e){let i=this.add((...r)=>{i.cancel(),e(...r)});return i}next(){return new Promise(e=>this.addOnce(e))}trigger(...e){this.handlers.forEach(i=>i(...e))}numListeners(){return this.handlers.size}clear(){this.handlers.clear()}},ee=class{static{n(this,"EventHandler")}handlers={};on(e,i){return this.handlers[e]||(this.handlers[e]=new $),this.handlers[e].add(i)}onOnce(e,i){let r=this.on(e,(...e)=>{r.cancel(),i(...e)});return r}next(e){return new Promise(i=>{this.onOnce(e,(...e)=>i(e[0]))})}trigger(e,...i){this.handlers[e]&&this.handlers[e].trigger(...i)}remove(e){delete this.handlers[e]}clear(){this.handlers={}}numListeners(e){return this.handlers[e]?.numListeners()??0}};function et(e,i){if(e===i)return!0;let r=typeof e,n=typeof i;if(r!==n)return!1;if("object"===r&&"object"===n&&null!==e&&null!==i){if(Array.isArray(e)!==Array.isArray(i))return!1;let r=Object.keys(e),n=Object.keys(i);if(r.length!==n.length)return!1;for(let n of r)if(!et(e[n],i[n]))return!1;return!0}return!1}function ei(e){let i=window.atob(e),r=i.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=i.charCodeAt(e);return n.buffer}function er(e){return ei(e.split(",")[1])}function en(e,i){let r=document.createElement("a");r.href=i,r.download=e,r.click()}function es(e,i){en(e,"data:text/plain;charset=utf-8,"+i)}function eo(e,i){es(e,JSON.stringify(i))}function ea(e,i){let r=URL.createObjectURL(i);en(e,r),URL.revokeObjectURL(r)}n(et,"deepEq"),n(ei,"base64ToArrayBuffer"),n(er,"dataURLToArrayBuffer"),n(en,"download"),n(es,"downloadText"),n(eo,"downloadJSON"),n(ea,"downloadBlob");var eh=n(e=>e.match(/^data:\w+\/\w+;base64,.+/),"isDataURL"),el=n(e=>e.split(".").slice(0,-1).join("."),"getFileName");function eu(e,i){return(...r)=>{let n=r.length;return n===e.length?e(...r):n===i.length?i(...r):void 0}}n(eu,"overload2");var ed=(e=0,()=>e++),ec=n(e=>e instanceof Error?e.message:String(e),"getErrorMessage"),ef=class{static{n(this,"BinaryHeap")}_items;_compareFn;constructor(e=(e,i)=>e<i){this._compareFn=e,this._items=[]}insert(e){this._items.push(e),this.moveUp(this._items.length-1)}remove(){if(0===this._items.length)return null;let e=this._items[0],i=this._items.pop();return 0!==this._items.length&&(this._items[0]=i,this.moveDown(0)),e}clear(){this._items.splice(0,this._items.length)}moveUp(e){for(;e>0;){let i=Math.floor((e-1)/2);if(!this._compareFn(this._items[e],this._items[i])&&this._items[e]>=this._items[i])break;this.swap(e,i),e=i}}moveDown(e){for(;e<Math.floor(this._items.length/2);){let i=2*e+1;if(i<this._items.length-1&&!this._compareFn(this._items[i],this._items[i+1])&&++i,this._compareFn(this._items[e],this._items[i]))break;this.swap(e,i),e=i}}swap(e,i){[this._items[e],this._items[i]]=[this._items[i],this._items[e]]}get length(){return this._items.length}},ep=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);function eg(e){if("string"!=typeof e)throw TypeError("string cannot be undefined or null");let i=[],r=0,n=0;for(;r<e.length;){if(n+=em(r+n,e),eb(e[r+n])&&n++,eV(e[r+n])&&n++,ex(e[r+n])&&n++,eS(e[r+n])){n++;continue}i.push(e.substring(r,r+n)),r+=n,n=0}return i}function em(e,i){let r=i[e];if(!ew(r)||e===i.length-1)return 1;let n=r+i[e+1],o=i.substring(e+2,e+5);return eA(n)&&eA(o)?4:ey(n)&&eE(o)?i.slice(e).indexOf(String.fromCodePoint(917631))+2:ev(o)?4:2}function ew(e){return e&&eM(e[0].charCodeAt(0),55296,56319)}function eA(e){return eM(eR(e),127462,127487)}function ey(e){return eM(eR(e),127988,127988)}function ev(e){return eM(eR(e),127995,127999)}function eV(e){return"string"==typeof e&&eM(e.charCodeAt(0),65024,65039)}function ex(e){return"string"==typeof e&&eM(e.charCodeAt(0),8400,8447)}function eE(e){let i=e.codePointAt(0);return"string"==typeof e&&"number"==typeof i&&eM(i,917504,917631)}function eb(e){return"string"==typeof e&&ep.includes(e.charCodeAt(0))}function eS(e){return"string"==typeof e&&8205===e.charCodeAt(0)}function eR(e){return(e.charCodeAt(0)-55296<<10)+(e.charCodeAt(1)-56320)+65536}function eM(e,i,r){return e>=i&&e<=r}n(eg,"runes"),n(em,"nextUnits"),n(ew,"isFirstOfSurrogatePair"),n(eA,"isRegionalIndicator"),n(ey,"isSubdivisionFlag"),n(ev,"isFitzpatrickModifier"),n(eV,"isVariationSelector"),n(ex,"isDiacriticalMark"),n(eE,"isSupplementarySpecialpurposePlane"),n(eb,"isGrapheme"),n(eS,"isZeroWidthJoiner"),n(eR,"codePointFromSurrogatePair"),n(eM,"betweenInclusive");var eT={"Joy-Con L+R (STANDARD GAMEPAD Vendor: 057e Product: 200e)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home",17:"capture"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}},"Joy-Con (L) (STANDARD GAMEPAD Vendor: 057e Product: 2006)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",9:"select",10:"lstick",16:"start"},sticks:{left:{x:0,y:1}}},"Joy-Con (R) (STANDARD GAMEPAD Vendor: 057e Product: 2007)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",9:"start",10:"lstick",16:"select"},sticks:{left:{x:0,y:1}}},"Pro Controller (STANDARD GAMEPAD Vendor: 057e Product: 2009)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home",17:"capture"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}},default:{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}}},eP=class{static{n(this,"ButtonState")}pressed=new Set([]);pressedRepeat=new Set([]);released=new Set([]);down=new Set([]);update(){this.pressed.clear(),this.released.clear(),this.pressedRepeat.clear()}press(e){this.pressed.add(e),this.pressedRepeat.add(e),this.down.add(e)}pressRepeat(e){this.pressedRepeat.add(e)}release(e){this.down.delete(e),this.pressed.delete(e),this.released.add(e)}},eB=class{static{n(this,"GamepadState")}buttonState=new eP;stickState=new Map},ek=class{static{n(this,"FPSCounter")}dts=[];timer=0;fps=0;tick(e){this.dts.push(e),this.timer+=e,this.timer>=1&&(this.timer=0,this.fps=Math.round(1/(this.dts.reduce((e,i)=>e+i)/this.dts.length)),this.dts=[])}},eF=n(e=>{if(!e.canvas)throw Error("Please provide a canvas");let i={canvas:e.canvas,loopID:null,stopped:!1,dt:0,time:0,realTime:0,fpsCounter:new ek,timeScale:1,skipTime:!1,numFrames:0,mousePos:new w(0),mouseDeltaPos:new w(0),keyState:new eP,mouseState:new eP,mergedGamepadState:new eB,gamepadStates:new Map,gamepads:[],charInputted:[],isMouseMoved:!1,lastWidth:e.canvas.offsetWidth,lastHeight:e.canvas.offsetHeight,events:new ee};function r(){return i.dt*i.timeScale}function o(){return i.time}function l(){return i.fpsCounter.fps}function u(){return i.numFrames}function c(){return i.canvas.toDataURL()}function f(e){i.canvas.style.cursor=e}function m(){return i.canvas.style.cursor}function A(e){if(e)try{let e=i.canvas.requestPointerLock();e.catch&&e.catch(e=>console.error(e))}catch(e){console.error(e)}else document.exitPointerLock()}function y(){return!!document.pointerLockElement}function v(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function V(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullScreen&&document.webkitExitFullScreen()}function x(){return document.fullscreenElement||document.webkitFullscreenElement}function E(e=!0){e?v(i.canvas):V()}function S(){return!!x()}function R(){for(let e in i.stopped=!0,eV)i.canvas.removeEventListener(e,eV[e]);for(let e in ex)document.removeEventListener(e,ex[e]);for(let e in eE)window.removeEventListener(e,eE[e]);eF.disconnect()}function T(o){null!==i.loopID&&cancelAnimationFrame(i.loopID);let l=0,u=n(n=>{if(i.stopped)return;if("visible"!==document.visibilityState){i.loopID=requestAnimationFrame(u);return}let c=n/1e3,f=c-i.realTime,g=e.maxFPS?1/e.maxFPS:0;i.realTime=c,(l+=f)>g&&(i.skipTime||(i.dt=l,i.time+=r(),i.fpsCounter.tick(i.dt)),l=0,i.skipTime=!1,i.numFrames++,em(),o(),ew()),i.loopID=requestAnimationFrame(u)},"frame");u(0)}function P(){return"ontouchstart"in window||navigator.maxTouchPoints>0}function B(){return i.mousePos.clone()}function k(){return i.mouseDeltaPos.clone()}function F(e="left"){return i.mouseState.pressed.has(e)}function I(e="left"){return i.mouseState.down.has(e)}function D(e="left"){return i.mouseState.released.has(e)}function C(){return i.isMouseMoved}function U(e){return void 0===e?i.keyState.pressed.size>0:i.keyState.pressed.has(e)}function N(e){return void 0===e?i.keyState.pressedRepeat.size>0:i.keyState.pressedRepeat.has(e)}function L(e){return void 0===e?i.keyState.down.size>0:i.keyState.down.has(e)}function O(e){return void 0===e?i.keyState.released.size>0:i.keyState.released.has(e)}function G(e){return void 0===e?i.mergedGamepadState.buttonState.pressed.size>0:i.mergedGamepadState.buttonState.pressed.has(e)}function q(e){return void 0===e?i.mergedGamepadState.buttonState.down.size>0:i.mergedGamepadState.buttonState.down.has(e)}function H(e){return void 0===e?i.mergedGamepadState.buttonState.released.size>0:i.mergedGamepadState.buttonState.released.has(e)}function K(e){return i.events.on("resize",e)}n(r,"dt"),n(o,"time"),n(l,"fps"),n(u,"numFrames"),n(c,"screenshot"),n(f,"setCursor"),n(m,"getCursor"),n(A,"setCursorLocked"),n(y,"isCursorLocked"),n(v,"enterFullscreen"),n(V,"exitFullscreen"),n(x,"getFullscreenElement"),n(E,"setFullscreen"),n(S,"isFullscreen"),n(R,"quit"),n(T,"run"),n(P,"isTouchscreen"),n(B,"mousePos"),n(k,"mouseDeltaPos"),n(F,"isMousePressed"),n(I,"isMouseDown"),n(D,"isMouseReleased"),n(C,"isMouseMoved"),n(U,"isKeyPressed"),n(N,"isKeyPressedRepeat"),n(L,"isKeyDown"),n(O,"isKeyReleased"),n(G,"isGamepadButtonPressed"),n(q,"isGamepadButtonDown"),n(H,"isGamepadButtonReleased"),n(K,"onResize");let j=eu(e=>i.events.on("keyDown",e),(e,r)=>i.events.on("keyDown",i=>i===e&&r(e))),Y=eu(e=>i.events.on("keyPress",e),(e,r)=>i.events.on("keyPress",i=>i===e&&r(e))),Q=eu(e=>i.events.on("keyPressRepeat",e),(e,r)=>i.events.on("keyPressRepeat",i=>i===e&&r(e))),z=eu(e=>i.events.on("keyRelease",e),(e,r)=>i.events.on("keyRelease",i=>i===e&&r(e))),J=eu(e=>i.events.on("mouseDown",i=>e(i)),(e,r)=>i.events.on("mouseDown",i=>i===e&&r(i))),X=eu(e=>i.events.on("mousePress",i=>e(i)),(e,r)=>i.events.on("mousePress",i=>i===e&&r(i))),W=eu(e=>i.events.on("mouseRelease",i=>e(i)),(e,r)=>i.events.on("mouseRelease",i=>i===e&&r(i)));function Z(e){return i.events.on("mouseMove",()=>e(B(),k()))}function _(e){return i.events.on("charInput",e)}function $(e){return i.events.on("touchStart",e)}function et(e){return i.events.on("touchMove",e)}function ei(e){return i.events.on("touchEnd",e)}function er(e){return i.events.on("scroll",e)}function en(e){return i.events.on("hide",e)}function es(e){return i.events.on("show",e)}function eo(e,r){return"function"==typeof e?i.events.on("gamepadButtonDown",e):"string"==typeof e&&"function"==typeof r?i.events.on("gamepadButtonDown",i=>i===e&&r(e)):void 0}function ea(e,r){return"function"==typeof e?i.events.on("gamepadButtonPress",e):"string"==typeof e&&"function"==typeof r?i.events.on("gamepadButtonPress",i=>i===e&&r(e)):void 0}function eh(e,r){return"function"==typeof e?i.events.on("gamepadButtonRelease",e):"string"==typeof e&&"function"==typeof r?i.events.on("gamepadButtonRelease",i=>i===e&&r(e)):void 0}function el(e,r){return i.events.on("gamepadStick",(i,n)=>i===e&&r(n))}function ed(e){i.events.on("gamepadConnect",e)}function ec(e){i.events.on("gamepadDisconnect",e)}function ef(e){return i.mergedGamepadState.stickState.get(e)||new w(0)}function ep(){return[...i.charInputted]}function eg(){return[...i.gamepads]}function em(){i.events.trigger("input"),i.keyState.down.forEach(e=>i.events.trigger("keyDown",e)),i.mouseState.down.forEach(e=>i.events.trigger("mouseDown",e)),ev()}function ew(){i.keyState.update(),i.mouseState.update(),i.mergedGamepadState.buttonState.update(),i.mergedGamepadState.stickState.forEach((e,r)=>{i.mergedGamepadState.stickState.set(r,new w(0))}),i.charInputted=[],i.isMouseMoved=!1,i.gamepadStates.forEach(e=>{e.buttonState.update(),e.stickState.forEach((i,r)=>{e.stickState.set(r,new w(0))})})}function eA(e){let r={index:e.index,isPressed:r=>i.gamepadStates.get(e.index).buttonState.pressed.has(r),isDown:r=>i.gamepadStates.get(e.index).buttonState.down.has(r),isReleased:r=>i.gamepadStates.get(e.index).buttonState.released.has(r),getStick:r=>i.gamepadStates.get(e.index).stickState.get(r)};return i.gamepads.push(r),i.gamepadStates.set(e.index,{buttonState:new eP,stickState:new Map([["left",new w(0)],["right",new w(0)]])}),r}function ey(e){i.gamepads=i.gamepads.filter(i=>i.index!==e.index),i.gamepadStates.delete(e.index)}function ev(){for(let e of navigator.getGamepads())e&&!i.gamepadStates.has(e.index)&&eA(e);for(let r of i.gamepads){let n=navigator.getGamepads()[r.index],o=(e.gamepads??{})[n.id]??eT[n.id]??eT.default,l=i.gamepadStates.get(r.index);for(let e=0;e<n.buttons.length;e++)n.buttons[e].pressed?(l.buttonState.down.has(o.buttons[e])||(i.mergedGamepadState.buttonState.press(o.buttons[e]),l.buttonState.press(o.buttons[e]),i.events.trigger("gamepadButtonPress",o.buttons[e])),i.events.trigger("gamepadButtonDown",o.buttons[e])):l.buttonState.down.has(o.buttons[e])&&(i.mergedGamepadState.buttonState.release(o.buttons[e]),l.buttonState.release(o.buttons[e]),i.events.trigger("gamepadButtonRelease",o.buttons[e]));for(let e in o.sticks){let r=o.sticks[e],u=new w(n.axes[r.x],n.axes[r.y]);l.stickState.set(e,u),i.mergedGamepadState.stickState.set(e,u),i.events.trigger("gamepadStick",e,u)}}}n(Z,"onMouseMove"),n(_,"onCharInput"),n($,"onTouchStart"),n(et,"onTouchMove"),n(ei,"onTouchEnd"),n(er,"onScroll"),n(en,"onHide"),n(es,"onShow"),n(eo,"onGamepadButtonDown"),n(ea,"onGamepadButtonPress"),n(eh,"onGamepadButtonRelease"),n(el,"onGamepadStick"),n(ed,"onGamepadConnect"),n(ec,"onGamepadDisconnect"),n(ef,"getGamepadStick"),n(ep,"charInputted"),n(eg,"getGamepads"),n(em,"processInput"),n(ew,"resetInput"),n(eA,"registerGamepad"),n(ey,"removeGamepad"),n(ev,"processGamepad");let eV={},ex={},eE={},eb=e.pixelDensity||window.devicePixelRatio||1;eV.mousemove=e=>{let r=new w(e.offsetX,e.offsetY),n=new w(e.movementX,e.movementY);if(S()){let n=i.canvas.width/eb,o=i.canvas.height/eb,l=window.innerWidth,u=window.innerHeight;if(l/u>n/o){let i=u/o,c=(l-n*i)/2;r.x=g(e.offsetX-c,0,n*i,0,n),r.y=g(e.offsetY,0,o*i,0,o)}else{let i=l/n,c=(u-o*i)/2;r.x=g(e.offsetX,0,n*i,0,n),r.y=g(e.offsetY-c,0,o*i,0,o)}}i.events.onOnce("input",()=>{i.isMouseMoved=!0,i.mousePos=r,i.mouseDeltaPos=n,i.events.trigger("mouseMove")})};let eS=["left","middle","right","back","forward"];eV.mousedown=e=>{i.events.onOnce("input",()=>{let r=eS[e.button];r&&(i.mouseState.press(r),i.events.trigger("mousePress",r))})},eV.mouseup=e=>{i.events.onOnce("input",()=>{let r=eS[e.button];r&&(i.mouseState.release(r),i.events.trigger("mouseRelease",r))})};let eR=new Set([" ","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab"]),eM={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"};for(let r in eV.keydown=e=>{eR.has(e.key)&&e.preventDefault(),i.events.onOnce("input",()=>{let r=eM[e.key]||e.key.toLowerCase();1===r.length?(i.events.trigger("charInput",r),i.charInputted.push(r)):"space"===r&&(i.events.trigger("charInput"," "),i.charInputted.push(" ")),e.repeat?(i.keyState.pressRepeat(r),i.events.trigger("keyPressRepeat",r)):(i.keyState.press(r),i.events.trigger("keyPressRepeat",r),i.events.trigger("keyPress",r))})},eV.keyup=e=>{i.events.onOnce("input",()=>{let r=eM[e.key]||e.key.toLowerCase();i.keyState.release(r),i.events.trigger("keyRelease",r)})},eV.touchstart=r=>{r.preventDefault(),i.events.onOnce("input",()=>{let n=[...r.changedTouches],o=i.canvas.getBoundingClientRect();!1!==e.touchToMouse&&(i.mousePos=new w(n[0].clientX-o.x,n[0].clientY-o.y),i.mouseState.press("left"),i.events.trigger("mousePress","left")),n.forEach(e=>{i.events.trigger("touchStart",new w(e.clientX-o.x,e.clientY-o.y),e)})})},eV.touchmove=r=>{r.preventDefault(),i.events.onOnce("input",()=>{let n=[...r.changedTouches],o=i.canvas.getBoundingClientRect();!1!==e.touchToMouse&&(i.mousePos=new w(n[0].clientX-o.x,n[0].clientY-o.y),i.events.trigger("mouseMove")),n.forEach(e=>{i.events.trigger("touchMove",new w(e.clientX-o.x,e.clientY-o.y),e)})})},eV.touchend=r=>{i.events.onOnce("input",()=>{let n=[...r.changedTouches],o=i.canvas.getBoundingClientRect();!1!==e.touchToMouse&&(i.mousePos=new w(n[0].clientX-o.x,n[0].clientY-o.y),i.mouseState.release("left"),i.events.trigger("mouseRelease","left")),n.forEach(e=>{i.events.trigger("touchEnd",new w(e.clientX-o.x,e.clientY-o.y),e)})})},eV.touchcancel=r=>{i.events.onOnce("input",()=>{let n=[...r.changedTouches],o=i.canvas.getBoundingClientRect();!1!==e.touchToMouse&&(i.mousePos=new w(n[0].clientX-o.x,n[0].clientY-o.y),i.mouseState.release("left"),i.events.trigger("mouseRelease","left")),n.forEach(e=>{i.events.trigger("touchEnd",new w(e.clientX-o.x,e.clientY-o.y),e)})})},eV.wheel=e=>{e.preventDefault(),i.events.onOnce("input",()=>{i.events.trigger("scroll",new w(e.deltaX,e.deltaY))})},eV.contextmenu=e=>e.preventDefault(),ex.visibilitychange=()=>{"visible"===document.visibilityState?(i.skipTime=!0,i.events.trigger("show")):i.events.trigger("hide")},eE.gamepadconnected=e=>{let r=eA(e.gamepad);i.events.onOnce("input",()=>{i.events.trigger("gamepadConnect",r)})},eE.gamepaddisconnected=e=>{let r=eg().filter(i=>i.index===e.gamepad.index)[0];ey(e.gamepad),i.events.onOnce("input",()=>{i.events.trigger("gamepadDisconnect",r)})},eV)i.canvas.addEventListener(r,eV[r]);for(let e in ex)document.addEventListener(e,ex[e]);for(let e in eE)window.addEventListener(e,eE[e]);let eF=new ResizeObserver(e=>{for(let r of e)if(r.target===i.canvas){if(i.lastWidth===i.canvas.offsetWidth&&i.lastHeight===i.canvas.offsetHeight)return;i.lastWidth=i.canvas.offsetWidth,i.lastHeight=i.canvas.offsetHeight,i.events.onOnce("input",()=>{i.events.trigger("resize")})}});return eF.observe(i.canvas),{dt:r,time:o,run:T,canvas:i.canvas,fps:l,numFrames:u,quit:R,setFullscreen:E,isFullscreen:S,setCursor:f,screenshot:c,getGamepads:eg,getCursor:m,setCursorLocked:A,isCursorLocked:y,isTouchscreen:P,mousePos:B,mouseDeltaPos:k,isKeyDown:L,isKeyPressed:U,isKeyPressedRepeat:N,isKeyReleased:O,isMouseDown:I,isMousePressed:F,isMouseReleased:D,isMouseMoved:C,isGamepadButtonPressed:G,isGamepadButtonDown:q,isGamepadButtonReleased:H,getGamepadStick:ef,charInputted:ep,onResize:K,onKeyDown:j,onKeyPress:Y,onKeyPressRepeat:Q,onKeyRelease:z,onMouseDown:J,onMousePress:X,onMouseRelease:W,onMouseMove:Z,onCharInput:_,onTouchStart:$,onTouchMove:et,onTouchEnd:ei,onScroll:er,onHide:en,onShow:es,onGamepadButtonDown:eo,onGamepadButtonPress:ea,onGamepadButtonRelease:eh,onGamepadStick:el,onGamepadConnect:ed,onGamepadDisconnect:ec,events:i.events}},"default"),eI=class e{static{n(this,"Texture")}ctx;src=null;glTex;width;height;constructor(e,i,r,n={}){this.ctx=e;let o=e.gl;this.glTex=e.gl.createTexture(),e.onDestroy(()=>this.free()),this.width=i,this.height=r;let l={linear:o.LINEAR,nearest:o.NEAREST}[n.filter??e.opts.texFilter]??o.NEAREST,u={repeat:o.REPEAT,clampToEadge:o.CLAMP_TO_EDGE}[n.wrap]??o.CLAMP_TO_EDGE;this.bind(),i&&r&&o.texImage2D(o.TEXTURE_2D,0,o.RGBA,i,r,0,o.RGBA,o.UNSIGNED_BYTE,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,l),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,l),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,u),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,u),this.unbind()}static fromImage(i,r,n={}){let o=new e(i,r.width,r.height,n);return o.update(r),o.src=r,o}update(e,i=0,r=0){let n=this.ctx.gl;this.bind(),n.texSubImage2D(n.TEXTURE_2D,0,i,r,n.RGBA,n.UNSIGNED_BYTE,e),this.unbind()}bind(){this.ctx.pushTexture2D(this.glTex)}unbind(){this.ctx.popTexture2D()}free(){this.ctx.gl.deleteTexture(this.glTex)}},eD=class{static{n(this,"FrameBuffer")}ctx;tex;glFramebuffer;glRenderbuffer;constructor(e,i,r,n={}){this.ctx=e;let o=e.gl;e.onDestroy(()=>this.free()),this.tex=new eI(e,i,r,n),this.glFramebuffer=o.createFramebuffer(),this.glRenderbuffer=o.createRenderbuffer(),this.bind(),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,i,r),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this.tex.glTex,0),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,this.glRenderbuffer),this.unbind()}get width(){return this.tex.width}get height(){return this.tex.height}toImageData(){let e=this.ctx.gl,i=new Uint8ClampedArray(this.width*this.height*4);this.bind(),e.readPixels(0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,i),this.unbind();let r=4*this.width,n=new Uint8Array(r);for(let e=0;e<(this.height/2|0);e++){let o=e*r,l=(this.height-e-1)*r;n.set(i.subarray(o,o+r)),i.copyWithin(o,l,l+r),i.set(n,l)}return new ImageData(i,this.width,this.height)}toDataURL(){let e=document.createElement("canvas"),i=e.getContext("2d");return e.width=this.width,e.height=this.height,i.putImageData(this.toImageData(),0,0),e.toDataURL()}draw(e){this.bind(),e(),this.unbind()}bind(){this.ctx.pushFramebuffer(this.glFramebuffer),this.ctx.pushRenderbuffer(this.glRenderbuffer),this.ctx.pushViewport({x:0,y:0,w:this.width,h:this.height})}unbind(){this.ctx.popFramebuffer(),this.ctx.popRenderbuffer(),this.ctx.popViewport()}free(){let e=this.ctx.gl;e.deleteFramebuffer(this.glFramebuffer),e.deleteRenderbuffer(this.glRenderbuffer),this.tex.free()}},eC=class{static{n(this,"Shader")}ctx;glProgram;constructor(e,i,r,n){this.ctx=e,e.onDestroy(()=>this.free());let o=e.gl,l=o.createShader(o.VERTEX_SHADER),u=o.createShader(o.FRAGMENT_SHADER);o.shaderSource(l,i),o.shaderSource(u,r),o.compileShader(l),o.compileShader(u);let c=o.createProgram();if(this.glProgram=c,o.attachShader(c,l),o.attachShader(c,u),n.forEach((e,i)=>o.bindAttribLocation(c,i,e)),o.linkProgram(c),!o.getProgramParameter(c,o.LINK_STATUS)){let e=o.getShaderInfoLog(l);if(e)throw Error("VERTEX SHADER "+e);let i=o.getShaderInfoLog(u);if(i)throw Error("FRAGMENT SHADER "+i)}o.deleteShader(l),o.deleteShader(u)}bind(){this.ctx.pushProgram(this.glProgram)}unbind(){this.ctx.popProgram()}send(e){let i=this.ctx.gl;for(let r in e){let n=e[r],o=i.getUniformLocation(this.glProgram,r);"number"==typeof n?i.uniform1f(o,n):n instanceof S?i.uniformMatrix4fv(o,!1,new Float32Array(n.m)):n instanceof y?i.uniform3f(o,n.r,n.g,n.b):n instanceof w&&i.uniform2f(o,n.x,n.y)}}free(){this.ctx.gl.deleteProgram(this.glProgram)}},eU=class{static{n(this,"BatchRenderer")}ctx;glVBuf;glIBuf;vqueue=[];iqueue=[];stride;maxVertices;maxIndices;vertexFormat;numDraws=0;curPrimitive=null;curTex=null;curShader=null;curUniform={};constructor(e,i,r,n){let o=e.gl;this.vertexFormat=i,this.ctx=e,this.stride=i.reduce((e,i)=>e+i.size,0),this.maxVertices=r,this.maxIndices=n,this.glVBuf=o.createBuffer(),e.pushArrayBuffer(this.glVBuf),o.bufferData(o.ARRAY_BUFFER,4*r,o.DYNAMIC_DRAW),e.popArrayBuffer(),this.glIBuf=o.createBuffer(),e.pushElementArrayBuffer(this.glIBuf),o.bufferData(o.ELEMENT_ARRAY_BUFFER,4*n,o.DYNAMIC_DRAW),e.popElementArrayBuffer()}push(e,i,r,n,o=null,l={}){(e!==this.curPrimitive||o!==this.curTex||n!==this.curShader||!et(this.curUniform,l)||this.vqueue.length+i.length*this.stride>this.maxVertices||this.iqueue.length+r.length>this.maxIndices)&&this.flush();let u=this.vqueue.length/this.stride;for(let e of i)this.vqueue.push(e);for(let e of r)this.iqueue.push(e+u);this.curPrimitive=e,this.curShader=n,this.curTex=o,this.curUniform=l}flush(){if(!this.curPrimitive||!this.curShader||0===this.vqueue.length||0===this.iqueue.length)return;let e=this.ctx.gl;this.ctx.pushArrayBuffer(this.glVBuf),e.bufferSubData(e.ARRAY_BUFFER,0,new Float32Array(this.vqueue)),this.ctx.pushElementArrayBuffer(this.glIBuf),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(this.iqueue)),this.ctx.setVertexFormat(this.vertexFormat),this.curShader.bind(),this.curShader.send(this.curUniform),this.curTex?.bind(),e.drawElements(this.curPrimitive,this.iqueue.length,e.UNSIGNED_SHORT,0),this.curTex?.unbind(),this.curShader.unbind(),this.ctx.popArrayBuffer(),this.ctx.popElementArrayBuffer(),this.vqueue=[],this.iqueue=[],this.numDraws++}free(){let e=this.ctx.gl;e.deleteBuffer(this.glVBuf),e.deleteBuffer(this.glIBuf)}};function eN(e){let i=[],r=n(r=>{i.push(r),e(r)},"push"),o=n(()=>{i.pop(),e(l()??null)},"pop"),l=n(()=>i[i.length-1],"cur");return[r,o,l]}function eL(e,i={}){let r=[];function o(e){r.push(e)}function l(){r.forEach(e=>e()),e.getExtension("WEBGL_lose_context").loseContext()}n(o,"onDestroy"),n(l,"destroy");let u=null;function c(i){if(et(i,u))return;u=i;let r=i.reduce((e,i)=>e+i.size,0);i.reduce((i,n,o)=>(e.vertexAttribPointer(o,n.size,e.FLOAT,!1,4*r,i),e.enableVertexAttribArray(o),i+4*n.size),0)}n(c,"setVertexFormat");let[f,g]=eN(i=>e.bindTexture(e.TEXTURE_2D,i)),[m,w]=eN(i=>e.bindBuffer(e.ARRAY_BUFFER,i)),[A,y]=eN(i=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i)),[v,V]=eN(i=>e.bindFramebuffer(e.FRAMEBUFFER,i)),[x,E]=eN(i=>e.bindRenderbuffer(e.RENDERBUFFER,i)),[S,R]=eN(({x:i,y:r,w:n,h:o})=>{e.viewport(i,r,n,o)}),[T,P]=eN(i=>e.useProgram(i));return S({x:0,y:0,w:e.drawingBufferWidth,h:e.drawingBufferHeight}),{gl:e,opts:i,onDestroy:o,destroy:l,pushTexture2D:f,popTexture2D:g,pushArrayBuffer:m,popArrayBuffer:w,pushElementArrayBuffer:A,popElementArrayBuffer:y,pushFramebuffer:v,popFramebuffer:V,pushRenderbuffer:x,popRenderbuffer:E,pushViewport:S,popViewport:R,pushProgram:T,popProgram:P,setVertexFormat:c}}n(eN,"genStack"),n(eL,"initGfx");var eO=class e{static{n(this,"Asset")}loaded=!1;data=null;error=null;onLoadEvents=new $;onErrorEvents=new $;onFinishEvents=new $;constructor(e){e.then(e=>{this.data=e,this.onLoadEvents.trigger(e)}).catch(e=>{if(this.error=e,this.onErrorEvents.numListeners()>0)this.onErrorEvents.trigger(e);else throw e}).finally(()=>{this.onFinishEvents.trigger(),this.loaded=!0})}static loaded(i){let r=new e(Promise.resolve(i));return r.data=i,r.loaded=!0,r}onLoad(e){return this.loaded&&this.data?e(this.data):this.onLoadEvents.add(e),this}onError(e){return this.loaded&&this.error?e(this.error):this.onErrorEvents.add(e),this}onFinish(e){return this.loaded?e():this.onFinishEvents.add(e),this}then(e){return this.onLoad(e)}catch(e){return this.onError(e)}finally(e){return this.onFinish(e)}},eG=class{static{n(this,"AssetBucket")}assets=new Map;lastUID=0;add(e,i){let r=e??this.lastUID+++"",n=new eO(i);return this.assets.set(r,n),n}addLoaded(e,i){let r=e??this.lastUID+++"",n=eO.loaded(i);return this.assets.set(r,n),n}get(e){return this.assets.get(e)}progress(){if(0===this.assets.size)return 1;let e=0;return this.assets.forEach(i=>{i.loaded&&e++}),e/this.assets.size}};function eq(e){return fetch(e).then(i=>{if(!i.ok)throw Error(`Failed to fetch "${e}"`);return i})}function eH(e){return eq(e).then(e=>e.json())}function eK(e){return eq(e).then(e=>e.text())}function ej(e){return eq(e).then(e=>e.arrayBuffer())}function eY(e){let i=new Image;return i.crossOrigin="anonymous",i.src=e,new Promise((r,n)=>{i.onload=()=>r(i),i.onerror=()=>n(Error(`Failed to load image from "${e}"`))})}n(eq,"fetchURL"),n(eH,"fetchJSON"),n(eK,"fetchText"),n(ej,"fetchArrayBuffer"),n(eY,"loadImg");var eQ=2*Math.PI/3,ez=2*Math.PI/4.5,eJ={linear:e=>e,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInQuad:e=>e*e,easeOutQuad:e=>1-(1-e)*(1-e),easeInOutQuad:e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2,easeInCubic:e=>e*e*e,easeOutCubic:e=>1-Math.pow(1-e,3),easeInOutCubic:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1-Math.pow(1-e,4),easeInOutQuart:e=>e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1-Math.pow(1-e,5),easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2,easeInExpo:e=>0===e?0:Math.pow(2,10*e-10),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2,easeInCirc:e=>1-Math.sqrt(1-Math.pow(e,2)),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2,easeInBack:e=>2.70158*e*e*e-1.70158*e*e,easeOutBack:e=>1+2.70158*Math.pow(e-1,3)+1.70158*Math.pow(e-1,2),easeInOutBack:e=>e<.5?Math.pow(2*e,2)*(7.189819*e-2.5949095)/2:(Math.pow(2*e-2,2)*(3.5949095*(2*e-2)+2.5949095)+2)/2,easeInElastic:e=>0===e?0:1===e?1:-Math.pow(2,10*e-10)*Math.sin((10*e-10.75)*eQ),easeOutElastic:e=>0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*eQ)+1,easeInOutElastic:e=>0===e?0:1===e?1:e<.5?-(Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*ez))/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*ez)/2+1,easeInBounce:e=>1-eJ.easeOutBounce(1-e),easeOutBounce:e=>e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,easeInOutBounce:e=>e<.5?(1-eJ.easeOutBounce(1-2*e))/2:(1+eJ.easeOutBounce(2*e-1))/2},eX=class{static{n(this,"TexPacker")}textures=[];canvas;c2d;x=0;y=0;curHeight=0;gfx;constructor(e,i,r){this.gfx=e,this.canvas=document.createElement("canvas"),this.canvas.width=i,this.canvas.height=r,this.textures=[eI.fromImage(e,this.canvas)],this.c2d=this.canvas.getContext("2d")}add(e){if(e.width>this.canvas.width||e.height>this.canvas.height)throw Error(`Texture size (${e.width} x ${e.height}) exceeds limit (${this.canvas.width} x ${this.canvas.height})`);this.x+e.width>this.canvas.width&&(this.x=0,this.y+=this.curHeight,this.curHeight=0),this.y+e.height>this.canvas.height&&(this.c2d.clearRect(0,0,this.canvas.width,this.canvas.height),this.textures.push(eI.fromImage(this.gfx,this.canvas)),this.x=0,this.y=0,this.curHeight=0);let i=this.textures[this.textures.length-1],r=new w(this.x,this.y);return this.x+=e.width,e.height>this.curHeight&&(this.curHeight=e.height),e instanceof ImageData?this.c2d.putImageData(e,r.x,r.y):this.c2d.drawImage(e,r.x,r.y),i.update(this.canvas),[i,new x(r.x/this.canvas.width,r.y/this.canvas.height,e.width/this.canvas.width,e.height/this.canvas.height)]}free(){for(let e of this.textures)e.free()}},eW=o("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L5QNSqT5iiySS9Ja2SV//5ME0ak//+4KgAAABgQBAADAMDgYCAEgCteQ0fZH6+ICXA357+MPfhR/+ywRf/U///LVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+5JknQAFoWhGLm5gBClBmT3GiAAAAAGkHAAAIAAANIOAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"),eZ=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",e_="topleft",e$="monospace",e0="linear",e1=[{name:"a_pos",size:2},{name:"a_uv",size:2},{name:"a_color",size:4}],e2=8192*e1.reduce((e,i)=>e+i.size,0),e5=`
attribute vec2 a_pos;
attribute vec2 a_uv;
attribute vec4 a_color;

varying vec2 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

vec4 def_vert() {
	return vec4(a_pos, 0.0, 1.0);
}

{{user}}

void main() {
	vec4 pos = vert(a_pos, a_uv, a_color);
	v_pos = a_pos;
	v_uv = a_uv;
	v_color = a_color;
	gl_Position = pos;
}
`,e4=`
precision mediump float;

varying vec2 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

uniform sampler2D u_tex;

vec4 def_frag() {
	return v_color * texture2D(u_tex, v_uv);
}

{{user}}

void main() {
	gl_FragColor = frag(v_pos, v_uv, v_color, u_tex);
	if (gl_FragColor.a == 0.0) {
		discard;
	}
}
`,e6=`
vec4 vert(vec2 pos, vec2 uv, vec4 color) {
	return def_vert();
}
`,e8=`
vec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {
	return def_frag();
}
`,e3=new Set(["id","require"]),e9=new Set(["add","update","draw","destroy","inspect","drawInspect"]);function e7(e){switch(e){case"topleft":return new w(-1,-1);case"top":return new w(0,-1);case"topright":return new w(1,-1);case"left":return new w(-1,0);case"center":return new w(0,0);case"right":return new w(1,0);case"botleft":return new w(-1,1);case"bot":return new w(0,1);case"botright":return new w(1,1);default:return e}}function te(e){switch(e){case"left":default:return 0;case"center":return .5;case"right":return 1}}function tt(e){return e.createBuffer(1,1,44100)}n(e7,"anchorPt"),n(te,"alignPt"),n(tt,"createEmptyAudioBuffer");const ti=n((e={})=>{let i,r,o,P,U,H,J,et,ei,ep,em,ew,eA,ey=e.root??document.body;ey===document.body&&(document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0px",document.documentElement.style.width="100%",document.documentElement.style.height="100%");let ev=e.canvas??(i=document.createElement("canvas"),ey.appendChild(i),i),eV=e.scale??1,ex=e.width&&e.height&&!e.stretch&&!e.letterbox;ex?(ev.width=e.width*eV,ev.height=e.height*eV):(ev.width=ev.parentElement.offsetWidth,ev.height=ev.parentElement.offsetHeight);let eE=["outline: none","cursor: default"];if(ex){let e=ev.width,i=ev.height;eE.push(`width: ${e}px`),eE.push(`height: ${i}px`)}else eE.push("width: 100%"),eE.push("height: 100%");e.crisp&&(eE.push("image-rendering: pixelated"),eE.push("image-rendering: crisp-edges")),ev.style.cssText=eE.join(";");let eb=e.pixelDensity||window.devicePixelRatio;ev.width*=eb,ev.height*=eb,ev.tabIndex=0;let eS=document.createElement("canvas");eS.width=256,eS.height=256;let eR=eS.getContext("2d",{willReadFrequently:!0}),eM=eF({canvas:ev,touchToMouse:e.touchToMouse,gamepads:e.gamepads,pixelDensity:e.pixelDensity,maxFPS:e.maxFPS}),eT=[],eP=eM.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0}),eB=eL(eP,{texFilter:e.texFilter}),ek=(r=tC(e6,e8),o=eI.fromImage(eB,new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1)),P=e.width&&e.height?new eD(eB,e.width*eb*eV,e.height*eb*eV):new eD(eB,eP.drawingBufferWidth,eP.drawingBufferHeight),U=null,H=1,e.background&&(U=v(e.background),H=Array.isArray(e.background)?e.background[3]:1,eP.clearColor(U.r/255,U.g/255,U.b/255,H??1)),eP.enable(eP.BLEND),eP.blendFuncSeparate(eP.SRC_ALPHA,eP.ONE_MINUS_SRC_ALPHA,eP.ONE,eP.ONE_MINUS_SRC_ALPHA),J=new eU(eB,e1,e2,12288),et=eI.fromImage(eB,new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2),{wrap:"repeat",filter:"nearest"}),{lastDrawCalls:0,defShader:r,defTex:o,frameBuffer:P,postShader:null,postShaderUniform:null,renderer:J,transform:new S,transformStack:[],bgTex:et,bgColor:U,bgAlpha:H,width:e.width??eP.drawingBufferWidth/eb/eV,height:e.height??eP.drawingBufferHeight/eb/eV,viewport:{x:0,y:0,width:eP.drawingBufferWidth,height:eP.drawingBufferHeight},fixed:!1});class eN{static{n(this,"SpriteData")}tex;frames=[new x(0,0,1,1)];anims={};slice9=null;constructor(e,i,r={},n=null){this.tex=e,i&&(this.frames=i),this.anims=r,this.slice9=n}get width(){return this.tex.width*this.frames[0].w}get height(){return this.tex.height*this.frames[0].h}static from(e,i={}){return"string"==typeof e?eN.fromURL(e,i):Promise.resolve(eN.fromImage(e,i))}static fromImage(e,i={}){let[r,n]=ez.packer.add(e);return new eN(r,i.frames?i.frames.map(e=>new x(n.x+e.x*n.w,n.y+e.y*n.h,e.w*n.w,e.h*n.h)):td(i.sliceX||1,i.sliceY||1,n.x,n.y,n.w,n.h),i.anims,i.slice9)}static fromURL(e,i={}){return eY(e).then(e=>eN.fromImage(e,i))}}class eq{static{n(this,"SoundData")}buf;constructor(e){this.buf=e}static fromArrayBuffer(e){return new Promise((i,r)=>eQ.ctx.decodeAudioData(e,i,r)).then(e=>new eq(e))}static fromURL(e){return eh(e)?eq.fromArrayBuffer(er(e)):ej(e).then(e=>eq.fromArrayBuffer(e))}}let eQ=((ep=(ei=new(window.AudioContext||window.webkitAudioContext)).createGain()).connect(ei.destination),em=new eq(tt(ei)),ei.decodeAudioData(eW.buffer.slice(0)).then(e=>{em.buf=e}).catch(e=>{console.error("Failed to load burp: ",e)}),{ctx:ei,masterNode:ep,burpSnd:em}),ez={urlPrefix:"",sprites:new eG,fonts:new eG,bitmapFonts:new eG,sounds:new eG,shaders:new eG,custom:new eG,packer:new eX(eB,2048,2048),loaded:!1};function ti(e){return"string"!=typeof e||eh(e)?e:ez.urlPrefix+e}n(ti,"fixURL");let tr={events:new ee,objEvents:new ee,root:iS([]),gravity:0,scenes:{},logs:[],cam:{pos:null,scale:new w(1),angle:0,shake:0,transform:new S}};function tn(e){return ez.custom.add(null,e)}function ts(){let e=[ez.sprites,ez.sounds,ez.shaders,ez.fonts,ez.bitmapFonts,ez.custom];return e.reduce((e,i)=>e+i.progress(),0)/e.length}function to(e){return void 0!==e&&(ez.urlPrefix=e),ez.urlPrefix}function ta(e,i){return ez.custom.add(e,eH(i))}tr.root.use(re()),n(tn,"load"),n(ts,"loadProgress"),n(to,"loadRoot"),n(ta,"loadJSON");class th{static{n(this,"FontData")}fontface;filter=e0;outline=null;size=64;constructor(e,i={}){if(this.fontface=e,this.filter=i.filter??e0,this.size=i.size??64,this.size>256)throw Error("Max font size: 256");i.outline&&(this.outline={width:1,color:v(0,0,0)},"number"==typeof i.outline?this.outline.width=i.outline:"object"==typeof i.outline&&(i.outline.width&&(this.outline.width=i.outline.width),i.outline.color&&(this.outline.color=i.outline.color)))}}function tl(e,i,r={}){let n=new FontFace(e,"string"==typeof i?`url(${i})`:i);return document.fonts.add(n),ez.fonts.add(e,n.load().catch(e=>{throw Error(`Failed to load font from "${i}": ${e}`)}).then(e=>new th(e,r)))}function tu(e,i,r,n,o={}){return ez.bitmapFonts.add(e,eY(i).then(e=>tU(eI.fromImage(eB,e,o),r,n,o.chars??eZ)))}function td(e=1,i=1,r=0,n=0,o=1,l=1){let u=[],c=o/e,f=l/i;for(let o=0;o<i;o++)for(let i=0;i<e;i++)u.push(new x(r+i*c,n+o*f,c,f));return u}function tc(e,i){return e=ti(e),tn("string"==typeof i?new Promise((r,n)=>{eH(i).then(i=>{tc(e,i).then(r).catch(n)})}):eN.from(e).then(e=>{let r={};for(let n in i){let o=i[n],l=e.frames[0],u=2048*l.w,c=2048*l.h,f=o.frames?o.frames.map(e=>new x(l.x+(o.x+e.x)/u*l.w,l.y+(o.y+e.y)/c*l.h,e.w/u*l.w,e.h/c*l.h)):td(o.sliceX||1,o.sliceY||1,l.x+o.x/u*l.w,l.y+o.y/c*l.h,o.width/u*l.w,o.height/c*l.h),g=new eN(e.tex,f,o.anims);ez.sprites.addLoaded(n,g),r[n]=g}return r}))}function tf(e,i={}){let r=document.createElement("canvas"),n=e[0].width,o=e[0].height;r.width=n*e.length,r.height=o;let l=r.getContext("2d");e.forEach((e,i)=>{e instanceof ImageData?l.putImageData(e,i*n,0):l.drawImage(e,i*n,0)});let u=l.getImageData(0,0,e.length*n,o);return eN.fromImage(u,{...i,sliceX:e.length,sliceY:1})}function tp(e,i,r={sliceX:1,sliceY:1,anims:{}}){return Array.isArray(i=ti(i))?i.some(e=>"string"==typeof e)?ez.sprites.add(e,Promise.all(i.map(e=>"string"==typeof e?eY(e):Promise.resolve(e))).then(e=>tf(e,r))):ez.sprites.addLoaded(e,tf(i,r)):"string"==typeof i?ez.sprites.add(e,eN.from(i,r)):ez.sprites.addLoaded(e,eN.fromImage(i,r))}function tg(e,i){return i=ti(i),ez.sprites.add(e,new Promise(async e=>{let r="string"==typeof i?await eH(i):i,n=await Promise.all(r.frames.map(eY)),o=document.createElement("canvas");o.width=r.width,o.height=r.height*r.frames.length;let l=o.getContext("2d");n.forEach((e,i)=>{l.drawImage(e,0,i*r.height)}),e(await tp(null,o,{sliceY:r.frames.length,anims:r.anims}))}))}function tm(e,i,r){i=ti(i),r=ti(r),"string"!=typeof i||r||(r=el(i)+".json");let n="string"==typeof r?eH(r):Promise.resolve(r);return ez.sprites.add(e,n.then(e=>{let r=e.meta.size,n=e.frames.map(e=>new x(e.frame.x/r.w,e.frame.y/r.h,e.frame.w/r.w,e.frame.h/r.h)),o={};for(let i of e.meta.frameTags)i.from===i.to?o[i.name]=i.from:o[i.name]={from:i.from,to:i.to,speed:10,loop:!0,pingpong:"pingpong"===i.direction};return eN.from(i,{frames:n,anims:o})}))}function tw(e,i,r){return ez.shaders.addLoaded(e,tC(i,r))}function tA(e,i,r){i=ti(i),r=ti(r);let o=n(e=>e?eK(e):Promise.resolve(null),"resolveUrl"),l=Promise.all([o(i),o(r)]).then(([e,i])=>tC(e,i));return ez.shaders.add(e,l)}function ty(e,i){return i=ti(i),ez.sounds.add(e,"string"==typeof i?eq.fromURL(i):eq.fromArrayBuffer(i))}function tv(e="bean"){return tp(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA1CAYAAADyMeOEAAAAAXNSR0IArs4c6QAAAoVJREFUaIHdm7txwkAQhheGAqACiCHzOKQDQrqgILpwSAeEDBnEUAF0gCMxZ7G72qce/mec2Lpf9+3unaS78wgSNZ8uX5729+d1FNWXUuGmXlBOUUEIMckEpeQJgBu6C+BSFngztBR2vd+ovY+7g+p6LbgaWgJrAeUkDYIUXgXdBBwNi6kpABJwMTQH3AZsXRR8GHTfgEth8E3gjdAUcNewpbTgY85sCMCUuOokozE0YM0YRzM9NGAAXd8+omAF5h4lnmBRvpSnZHyLoLEbaN+aKB9KWv/KWw0tAbbANnlG+UvB2dm77NxxdwgBpjrF/d7rW9cbmpvio2A5z8iAYpVU8pGZlo6/2+MSco2lHfd3rv9jAP038e1xef9o2mjvYb2OqpqKE81028/jeietlSEVO5FRWsxWsJit1G3aFpW8iWe5RwpiCZAk25QvV6nz6fIlynRGuTd5WqpJ4guAlDfVKBK87hXljflgv1ON6fV+4+5gVlA17SfeG0heKqQd4l4jI/wrmaA9N9R4ar+wpHJDZyrrfcH0nB66PqAzPi76pn+faSyJk/vzOorYhGurQrzj/P68jtBMawHaHBIR9xoD5O34dy0qQOSYHvqExq2TpT2nf76+w7y251OYF0CRaU+J920TwLUa6inx6OxE6g80lu2ux7Y2eJLF/rCXE6zEPdnenk9o+4ih9AEdnW2q81HXl5LuU6OTl2fXUhqganbXAGq3g6jJOWV/OnoesO6YqqEB/GdNsjf7uHtwj2DzmRNpp7iOZfm6D9oAxB6Yi1gC4oIYeo4MIPdopEQRB+cAko5J1tW386HpB2Kz1eop4Epdwls/kgZ1sh8gZsEjdcWkr//D8Qu3Z3l5Nl1NtAAAAABJRU5ErkJggg==")}function tV(e){return ez.sprites.get(e)}function tx(e){return ez.sounds.get(e)}function tE(e){return ez.fonts.get(e)}function tb(e){return ez.bitmapFonts.get(e)}function tS(e){return ez.shaders.get(e)}function tR(e){return ez.custom.get(e)}function tM(e){if("string"==typeof e){let i=tV(e);if(i)return i;if(1>ts())return null;throw Error(`Sprite not found: ${e}`)}if(e instanceof eN)return eO.loaded(e);if(e instanceof eO)return e;throw Error(`Invalid sprite: ${e}`)}function tT(e){if("string"==typeof e){let i=tx(e);if(i)return i;if(1>ts())return null;throw Error(`Sound not found: ${e}`)}if(e instanceof eq)return eO.loaded(e);if(e instanceof eO)return e;throw Error(`Invalid sound: ${e}`)}function tP(e){if(!e)return ek.defShader;if("string"==typeof e){let i=tS(e);if(i)return i.data??i;if(1>ts())return null;throw Error(`Shader not found: ${e}`)}return e instanceof eO&&e.data?e.data:e}function tB(i){if(!i)return tB(e.font??"monospace");if("string"==typeof i){let e=tb(i),r=tE(i);if(e)return e.data??e;if(r)return r.data??r;if(document.fonts.check(`64px ${i}`))return i;if(1>ts())return null;throw Error(`Font not found: ${i}`)}return i instanceof eO&&i.data?i.data:i}function tk(e){return void 0!==e&&(eQ.masterNode.gain.value=e),eQ.masterNode.gain.value}function tF(e,i={}){let r=eQ.ctx,o=i.paused??!1,l=r.createBufferSource(),u=new $,c=r.createGain(),f=i.seek??0,g=0,m=0,w=!1;l.loop=!!i.loop,l.detune.value=i.detune??0,l.playbackRate.value=i.speed??1,l.connect(c),l.onended=()=>{v()>=l.buffer?.duration&&u.trigger()},c.connect(eQ.masterNode),c.gain.value=i.volume??1;let A=n(e=>{l.buffer=e.buf,o||(g=r.currentTime,l.start(0,f),w=!0)},"start"),y=tT(e);y instanceof eO&&y.onLoad(A);let v=n(()=>{if(!l.buffer)return 0;let e=o?m-g:r.currentTime-g,i=l.buffer.duration;return l.loop?e%i:Math.min(e,i)},"getTime"),V=n(e=>{let i=r.createBufferSource();return i.buffer=e.buffer,i.loop=e.loop,i.playbackRate.value=e.playbackRate.value,i.detune.value=e.detune.value,i.onended=e.onended,i.connect(c),i},"cloneNode");return{stop(){this.paused=!0,this.seek(0)},set paused(M){if(o!==M){if(o=M,M)w&&(l.stop(),w=!1),m=r.currentTime;else{l=V(l);let e=m-g;l.start(0,e),w=!0,g=r.currentTime-e,m=0}}},get paused(){return o},play(e=0){this.seek(e),this.paused=!1},seek(e){l.buffer?.duration&&(e>l.buffer.duration||(o?(l=V(l),g=m-e):(l.stop(),l=V(l),g=r.currentTime-e,l.start(0,e),w=!0,m=0)))},set speed(M){l.playbackRate.value=M},get speed(){return l.playbackRate.value},set detune(M){l.detune.value=M},get detune(){return l.detune.value},set volume(M){c.gain.value=Math.max(M,0)},get volume(){return c.gain.value},set loop(M){l.loop=M},get loop(){return l.loop},duration:()=>l.buffer?.duration??0,time(){return v()%this.duration()},onEnd:e=>u.add(e),then(e){return this.onEnd(e)}}}function tI(e){return tF(eQ.burpSnd,e)}function tD(e,i){return new eD(eB,e,i)}function tC(e=e6,i=e8){let r=e5.replace("{{user}}",e??e6),n=e4.replace("{{user}}",i??e8);try{return new eC(eB,r,n,e1.map(e=>e.name))}catch(o){let e=ec(o).match(/(?<type>^\w+) SHADER ERROR: 0:(?<line>\d+): (?<msg>.+)/),i=Number(e.groups.line)-14,r=e.groups.msg.trim(),n=e.groups.type.toLowerCase();throw Error(`${n} shader line ${i}: ${r}`)}}function tU(e,i,r,n){let o=e.width/i,l={};for(let[e,u]of n.split("").entries())l[u]=new x(e%o*i,Math.floor(e/o)*r,i,r);return{tex:e,map:l,size:r}}function tN(e,i,r,n=ek.defTex,o=ek.defShader,l={}){let u=tP(o);if(!u||u instanceof eO)return;let c=ek.fixed||r?ek.transform:tr.cam.transform.mult(ek.transform),f=[];for(let i of e){let e=tH(c.multVec2(i.pos));f.push(e.x,e.y,i.uv.x,i.uv.y,i.color.r/255,i.color.g/255,i.color.b/255,i.opacity)}ek.renderer.push(eP.TRIANGLES,f,i,u,n,l)}function tL(){ek.renderer.flush()}function tO(){eP.clear(eP.COLOR_BUFFER_BIT),ek.frameBuffer.bind(),eP.clear(eP.COLOR_BUFFER_BIT),ek.bgColor||ie(()=>{tX({width:il(),height:iu(),quad:new x(0,0,il()/64,iu()/64),tex:ek.bgTex,fixed:!0})}),ek.renderer.numDraws=0,ek.fixed=!1,ek.transformStack.length=0,ek.transform=new S}function tG(e,i){ek.postShader=e,ek.postShaderUniform=i??null}function tq(){tL(),ek.lastDrawCalls=ek.renderer.numDraws,ek.frameBuffer.unbind(),eP.viewport(0,0,eP.drawingBufferWidth,eP.drawingBufferHeight);let e=ek.width,i=ek.height;ek.width=eP.drawingBufferWidth/eb,ek.height=eP.drawingBufferHeight/eb,tW({flipY:!0,tex:ek.frameBuffer.tex,pos:new w(ek.viewport.x,ek.viewport.y),width:ek.viewport.width,height:ek.viewport.height,shader:ek.postShader,uniform:"function"==typeof ek.postShaderUniform?ek.postShaderUniform():ek.postShaderUniform,fixed:!0}),tL(),ek.width=e,ek.height=i}function tH(e){return new w(e.x/il()*2-1,-e.y/iu()*2+1)}function tK(e){ek.transform=e.clone()}function tj(...e){if(void 0===e[0])return;let i=A(...e);0===i.x&&0===i.y||ek.transform.translate(i)}function tY(...e){if(void 0===e[0])return;let i=A(...e);1===i.x&&1===i.y||ek.transform.scale(i)}function tQ(e){e&&ek.transform.rotate(e)}function tz(){ek.transformStack.push(ek.transform.clone())}function tJ(){ek.transformStack.length>0&&(ek.transform=ek.transformStack.pop())}function tX(e){if(void 0===e.width||void 0===e.height)throw Error('drawUVQuad() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let i=e.width,r=e.height,n=e7(e.anchor||e_).scale(new w(i,r).scale(-.5)),o=e.quad||new x(0,0,1,1),l=e.color||v(255,255,255),u=e.opacity??1,c=e.tex?.1/e.tex.width:0,f=e.tex?.1/e.tex.height:0,g=o.x+c,m=o.y+f,A=o.w-2*c,y=o.h-2*f;tz(),tj(e.pos),tQ(e.angle),tY(e.scale),tj(n),tN([{pos:new w(-i/2,r/2),uv:new w(e.flipX?g+A:g,e.flipY?m:m+y),color:l,opacity:u},{pos:new w(-i/2,-r/2),uv:new w(e.flipX?g+A:g,e.flipY?m+y:m),color:l,opacity:u},{pos:new w(i/2,-r/2),uv:new w(e.flipX?g:g+A,e.flipY?m+y:m),color:l,opacity:u},{pos:new w(i/2,r/2),uv:new w(e.flipX?g:g+A,e.flipY?m:m+y),color:l,opacity:u}],[0,1,3,1,2,3],e.fixed,e.tex,e.shader,e.uniform),tJ()}function tW(e){if(!e.tex)throw Error('drawTexture() requires property "tex".');let i=e.quad??new x(0,0,1,1),r=e.tex.width*i.w,n=e.tex.height*i.h,o=new w(1);if(e.tiled){let l=Math.ceil((e.width||r)/r),u=Math.ceil((e.height||n)/n),c=e7(e.anchor||e_).add(new w(1,1)).scale(.5).scale(l*r,u*n);for(let f=0;f<l;f++)for(let l=0;l<u;l++)tX(Object.assign({},e,{pos:(e.pos||new w(0)).add(new w(r*f,n*l)).sub(c),scale:o.scale(e.scale||new w(1)),tex:e.tex,quad:i,width:r,height:n,anchor:"topleft"}))}else e.width&&e.height?(o.x=e.width/r,o.y=e.height/n):e.width?(o.x=e.width/r,o.y=o.x):e.height&&(o.y=e.height/n,o.x=o.y),tX(Object.assign({},e,{scale:o.scale(e.scale||new w(1)),tex:e.tex,quad:i,width:r,height:n}))}function tZ(e){if(!e.sprite)throw Error('drawSprite() requires property "sprite"');let i=tM(e.sprite);if(!i||!i.data)return;let r=i.data.frames[e.frame??0];if(!r)throw Error(`Frame not found: ${e.frame??0}`);tW(Object.assign({},e,{tex:i.data.tex,quad:r.scale(e.quad??new x(0,0,1,1))}))}function t_(e,i,r,n,o,u=1){n=l(n%360),(o=l(o%360))<=n&&(o+=2*Math.PI);let c=[],f=Math.ceil((o-n)/l(8)*u),g=(o-n)/f;for(let l=n;l<o;l+=g)c.push(e.add(i*Math.cos(l),r*Math.sin(l)));return c.push(e.add(i*Math.cos(o),r*Math.sin(o))),c}function t$(e){if(void 0===e.width||void 0===e.height)throw Error('drawRect() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let i=e.width,r=e.height,n=e7(e.anchor||e_).add(1,1).scale(new w(i,r).scale(-.5)),o=[new w(0,0),new w(i,0),new w(i,r),new w(0,r)];if(e.radius){let n=Math.min(Math.min(i,r)/2,e.radius);o=[new w(n,0),new w(i-n,0),...t_(new w(i-n,n),n,n,270,360),new w(i,n),new w(i,r-n),...t_(new w(i-n,r-n),n,n,0,90),new w(i-n,r),new w(n,r),...t_(new w(n,r-n),n,n,90,180),new w(0,r-n),new w(0,n),...t_(new w(n,n),n,n,180,270)]}t6(Object.assign({},e,{offset:n,pts:o,...e.gradient?{colors:e.horizontal?[e.gradient[0],e.gradient[1],e.gradient[1],e.gradient[0]]:[e.gradient[0],e.gradient[0],e.gradient[1],e.gradient[1]]}:{}}))}function t0(e){let{p1:i,p2:r}=e;if(!i||!r)throw Error('drawLine() requires properties "p1" and "p2".');let n=e.width||1,o=r.sub(i).unit().normal().scale(.5*n);tN([i.sub(o),i.add(o),r.add(o),r.sub(o)].map(i=>({pos:new w(i.x,i.y),uv:new w(0),color:e.color??y.WHITE,opacity:e.opacity??1})),[0,1,3,1,2,3],e.fixed,ek.defTex,e.shader,e.uniform)}function t1(e){let i=e.pts;if(!i)throw Error('drawLines() requires property "pts".');if(!(i.length<2)){if(e.radius&&i.length>=3){let r=i[0].sdist(i[1]);for(let e=1;e<i.length-1;e++)r=Math.min(i[e].sdist(i[e+1]),r);e.radius,t0(Object.assign({},e,{p1:i[0],p2:i[1]}));for(let r=1;r<i.length-2;r++)t0(Object.assign({},e,{p1:i[r],p2:i[r+1]}));t0(Object.assign({},e,{p1:i[i.length-2],p2:i[i.length-1]}))}else for(let r=0;r<i.length-1;r++)t0(Object.assign({},e,{p1:i[r],p2:i[r+1]})),"none"!==e.join&&t5(Object.assign({},e,{pos:i[r],radius:e.width/2}))}}function t2(e){if(!e.p1||!e.p2||!e.p3)throw Error('drawTriangle() requires properties "p1", "p2" and "p3".');return t6(Object.assign({},e,{pts:[e.p1,e.p2,e.p3]}))}function t5(e){if("number"!=typeof e.radius)throw Error('drawCircle() requires property "radius".');0!==e.radius&&t4(Object.assign({},e,{radiusX:e.radius,radiusY:e.radius,angle:0}))}function t4(e){if(void 0===e.radiusX||void 0===e.radiusY)throw Error('drawEllipse() requires properties "radiusX" and "radiusY".');if(0===e.radiusX||0===e.radiusY)return;let i=e.start??0,r=e.end??360,n=e7(e.anchor??"center").scale(new w(-e.radiusX,-e.radiusY)),o=t_(n,e.radiusX,e.radiusY,i,r,e.resolution);o.unshift(n);let l=Object.assign({},e,{pts:o,radius:0,...e.gradient?{colors:[e.gradient[0],...Array(o.length-1).fill(e.gradient[1])]}:{}});if(r-i>=360&&e.outline){!1!==e.fill&&t6(Object.assign(l,{outline:null})),t6(Object.assign(l,{pts:o.slice(1),fill:!1}));return}t6(l)}function t6(e){if(!e.pts)throw Error('drawPolygon() requires property "pts".');let i=e.pts.length;if(!(i<3)){if(tz(),tj(e.pos),tY(e.scale),tQ(e.angle),tj(e.offset),!1!==e.fill){let r=e.color??y.WHITE,n=e.pts.map((i,n)=>({pos:new w(i.x,i.y),uv:new w(0,0),color:e.colors&&e.colors[n]?e.colors[n].mult(r):r,opacity:e.opacity??1})),o=[...Array(i-2).keys()].map(e=>[0,e+1,e+2]).flat();tN(n,e.indices??o,e.fixed,ek.defTex,e.shader,e.uniform)}e.outline&&t1({pts:[...e.pts,e.pts[0]],radius:e.radius,width:e.outline.width,color:e.outline.color,join:e.outline.join,uniform:e.uniform,fixed:e.fixed,opacity:e.opacity}),tJ()}}function t8(e,i,r){tL(),eP.clear(eP.STENCIL_BUFFER_BIT),eP.enable(eP.STENCIL_TEST),eP.stencilFunc(eP.NEVER,1,255),eP.stencilOp(eP.REPLACE,eP.REPLACE,eP.REPLACE),i(),tL(),eP.stencilFunc(r,1,255),eP.stencilOp(eP.KEEP,eP.KEEP,eP.KEEP),e(),tL(),eP.disable(eP.STENCIL_TEST)}function t3(e,i){t8(e,i,eP.EQUAL)}function t9(e,i){t8(e,i,eP.NOTEQUAL)}function t7(){return(ek.viewport.width+ek.viewport.height)/(ek.width+ek.height)}function ie(e){tL();let i=ek.width,r=ek.height;ek.width=ek.viewport.width,ek.height=ek.viewport.height,e(),tL(),ek.width=i,ek.height=r}function it(e,i){i.pos&&(e.pos=e.pos.add(i.pos)),i.scale&&(e.scale=e.scale.scale(A(i.scale))),i.angle&&(e.angle+=i.angle),i.color&&1===e.ch.length&&(e.color=e.color.mult(i.color)),i.opacity&&(e.opacity*=i.opacity)}n(tl,"loadFont"),n(tu,"loadBitmapFont"),n(td,"slice"),n(tc,"loadSpriteAtlas"),n(tf,"createSpriteSheet"),n(tp,"loadSprite"),n(tg,"loadPedit"),n(tm,"loadAseprite"),n(tw,"loadShader"),n(tA,"loadShaderURL"),n(ty,"loadSound"),n(tv,"loadBean"),n(tV,"getSprite"),n(tx,"getSound"),n(tE,"getFont"),n(tb,"getBitmapFont"),n(tS,"getShader"),n(tR,"getAsset"),n(tM,"resolveSprite"),n(tT,"resolveSound"),n(tP,"resolveShader"),n(tB,"resolveFont"),n(tk,"volume"),n(tF,"play"),n(tI,"burp"),n(tD,"makeCanvas"),n(tC,"makeShader"),n(tU,"makeFont"),n(tN,"drawRaw"),n(tL,"flush"),n(tO,"frameStart"),n(tG,"usePostEffect"),n(tq,"frameEnd"),n(tH,"screen2ndc"),n(tK,"pushMatrix"),n(tj,"pushTranslate"),n(tY,"pushScale"),n(tQ,"pushRotate"),n(tz,"pushTransform"),n(tJ,"popTransform"),n(tX,"drawUVQuad"),n(tW,"drawTexture"),n(tZ,"drawSprite"),n(t_,"getArcPts"),n(t$,"drawRect"),n(t0,"drawLine"),n(t1,"drawLines"),n(t2,"drawTriangle"),n(t5,"drawCircle"),n(t4,"drawEllipse"),n(t6,"drawPolygon"),n(t8,"drawStenciled"),n(t3,"drawMasked"),n(t9,"drawSubtracted"),n(t7,"getViewportScale"),n(ie,"drawUnscaled"),n(it,"applyCharTransform");let ii=/\[(?<style>\w+)\](?<text>.*?)\[\/\k<style>\]/g;function ir(e){let i={},r=e.replace(ii,"$2"),n=0;for(let r of e.matchAll(ii)){let e=r.index-n;for(let n=0;n<r.groups.text.length;n++)i[n+e]=[r.groups.style];n+=r[0].length-r.groups.text.length}return{charStyleMap:i,text:r}}n(ir,"compileStyledText");let is={};function io(e){if(void 0===e.text)throw Error('formatText() requires property "text".');let i=tB(e.font);if(""===e.text||i instanceof eO||!i)return{width:0,height:0,chars:[],opt:e};let{charStyleMap:r,text:n}=ir(e.text+""),o=eg(n);if(i instanceof th||"string"==typeof i){let e=i instanceof th?i.fontface.family:i,r=i instanceof th?{outline:i.outline,filter:i.filter}:{outline:null,filter:e0},n=is[e]??{font:{tex:new eI(eB,2048,2048,{filter:r.filter}),map:{},size:64},cursor:new w(0),outline:r.outline};for(let r of(is[e]||(is[e]=n),i=n.font,o))if(!n.font.map[r]){eR.clearRect(0,0,eS.width,eS.height),eR.font=`${i.size}px ${e}`,eR.textBaseline="top",eR.textAlign="left",eR.fillStyle="#ffffff";let o=Math.ceil(eR.measureText(r).width),l=i.size;n.outline&&(eR.lineJoin="round",eR.lineWidth=2*n.outline.width,eR.strokeStyle=n.outline.color.toHex(),eR.strokeText(r,n.outline.width,n.outline.width),o+=2*n.outline.width,l+=3*n.outline.width),eR.fillText(r,n.outline?.width??0,n.outline?.width??0);let u=eR.getImageData(0,0,o,l);if(n.cursor.x+o>2048&&(n.cursor.x=0,n.cursor.y+=l,n.cursor.y>2048))throw Error("Font atlas exceeds character limit");i.tex.update(u,n.cursor.x,n.cursor.y),i.map[r]=new x(n.cursor.x,n.cursor.y,o,l),n.cursor.x+=o}}let l=e.size||i.size,u=A(e.scale??1).scale(l/i.size),c=e.lineSpacing??0,f=e.letterSpacing??0,g=0,m=0,v=0,V=[],E=[],S=0,R=null,T=null;for(;S<o.length;){let r=o[S];if(r===`
`)v+=l+c,V.push({width:g-f,chars:E}),R=null,T=null,g=0,E=[];else{let n=i.map[r];if(n){let P=n.w*u.x;e.width&&g+P>e.width&&(v+=l+c,null!=R&&(S-=E.length-R,r=o[S],P=(n=i.map[r]).w*u.x,E=E.slice(0,R-1),g=T),R=null,T=null,V.push({width:g-f,chars:E}),g=0,E=[]),E.push({tex:i.tex,width:n.w,height:n.h,quad:new x(n.x/i.tex.width,n.y/i.tex.height,n.w/i.tex.width,n.h/i.tex.height),ch:r,pos:new w(g,v),opacity:e.opacity??1,color:e.color??y.WHITE,scale:A(u),angle:0})," "===r&&(R=E.length,T=g),g+=P,m=Math.max(m,g),g+=f}}S++}V.push({width:g-f,chars:E}),v+=l,e.width&&(m=e.width);let P=[];for(let n of V){let o=(m-n.width)*te(e.align??"left");for(let l of n.chars){let n=i.map[l.ch],c=P.length;if(l.pos=l.pos.add(o,0).add(n.w*u.x*.5,n.h*u.y*.5),e.transform){let i="function"==typeof e.transform?e.transform(c,l.ch):e.transform;i&&it(l,i)}if(r[c])for(let i of r[c]){let r=e.styles[i],n="function"==typeof r?r(c,l.ch):r;n&&it(l,n)}P.push(l)}}return{width:m,height:v,chars:P,opt:e}}function ia(e){ih(io(e))}function ih(e){tz(),tj(e.opt.pos),tQ(e.opt.angle),tj(e7(e.opt.anchor??"topleft").add(1,1).scale(e.width,e.height).scale(-.5)),e.chars.forEach(i=>{tX({tex:i.tex,width:i.width,height:i.height,pos:i.pos,scale:i.scale,angle:i.angle,color:i.color,opacity:i.opacity,quad:i.quad,anchor:"center",uniform:e.opt.uniform,shader:e.opt.shader,fixed:e.opt.fixed})}),tJ()}function il(){return ek.width}function iu(){return ek.height}function id(e){return new w((e.x-ek.viewport.x)*il()/ek.viewport.width,(e.y-ek.viewport.y)*iu()/ek.viewport.height)}function ic(e){return new w(e.x*ek.viewport.width/ek.width,e.y*ek.viewport.height/ek.height)}function ip(){return id(eM.mousePos())}n(io,"formatText"),n(ia,"drawText"),n(ih,"drawFormattedText"),n(il,"width"),n(iu,"height"),n(id,"windowToContent"),n(ic,"contentToView"),n(ip,"mousePos");let ig=!1,im={inspect:!1,timeScale:1,showLog:!0,fps:()=>eM.fps(),numFrames:()=>eM.numFrames(),stepFrame:rN,drawCalls:()=>ek.lastDrawCalls,clearLog:()=>tr.logs=[],log:i=>{let r=e.logMax??8;tr.logs.unshift({msg:i,time:eM.time()}),tr.logs.length>r&&(tr.logs=tr.logs.slice(0,r))},error:e=>im.log(Error(e.toString?e.toString():e)),curRecording:null,numObjects:()=>rP("*",{recursive:!0}).length,get paused(){return ig},set paused(t){ig=t,t?eQ.ctx.suspend():eQ.ctx.resume()}};function iw(){return eM.dt()*im.timeScale}function iA(...e){return e.length>0&&(tr.cam.pos=A(...e)),tr.cam.pos?tr.cam.pos.clone():ry()}function iy(...e){return e.length>0&&(tr.cam.scale=A(...e)),tr.cam.scale.clone()}function iv(e){return void 0!==e&&(tr.cam.angle=e),tr.cam.angle}function iV(e=12){tr.cam.shake+=e}function ix(e){return tr.cam.transform.multVec2(e)}function iE(e){return tr.cam.transform.invert().multVec2(e)}function ib(e){let i=new S;return e.pos&&i.translate(e.pos),e.scale&&i.scale(e.scale),e.angle&&i.rotate(e.angle),e.parent?i.mult(e.parent.transform):i}function iS(e=[]){let i=new Map,r={},o=new ee,l=[],u=null,c=!1,f={id:ed(),hidden:!1,transform:new S,children:[],parent:null,set paused(d){if(d!==c)for(let e of(c=d,l))e.paused=d},get paused(){return c},add(e=[]){let i=Array.isArray(e)?iS(e):e;if(i.parent)throw Error("Cannot add a game obj that already has a parent.");return i.parent=this,i.transform=ib(i),this.children.push(i),i.trigger("add",i),tr.events.trigger("add",i),i},readd(e){let i=this.children.indexOf(e);return -1!==i&&(this.children.splice(i,1),this.children.push(e)),e},remove(e){let i=this.children.indexOf(e);if(-1!==i){e.parent=null,this.children.splice(i,1);let r=n(e=>{e.trigger("destroy"),tr.events.trigger("destroy",e),e.children.forEach(e=>r(e))},"trigger");r(e)}},removeAll(e){if(e)this.get(e).forEach(e=>this.remove(e));else for(let e of[...this.children])this.remove(e)},update(){this.paused||(this.children.sort((e,i)=>(e.z??0)-(i.z??0)).forEach(e=>e.update()),this.trigger("update"))},draw(){if(this.hidden)return;this.canvas&&this.canvas.bind();let e=ek.fixed;this.fixed&&(ek.fixed=!0),tz(),tj(this.pos),tY(this.scale),tQ(this.angle);let i=this.children.sort((e,i)=>(e.z??0)-(i.z??0));if(this.mask){let e={intersect:t3,subtract:t9}[this.mask];if(!e)throw Error(`Invalid mask func: "${this.mask}"`);e(()=>{i.forEach(e=>e.draw())},()=>{this.trigger("draw")})}else this.trigger("draw"),i.forEach(e=>e.draw());tJ(),ek.fixed=e,this.canvas&&this.canvas.unbind()},drawInspect(){this.hidden||(tz(),tj(this.pos),tY(this.scale),tQ(this.angle),this.children.sort((e,i)=>(e.z??0)-(i.z??0)).forEach(e=>e.drawInspect()),this.trigger("drawInspect"),tJ())},use(e){if(!e)return;if("string"==typeof e)return this.use({id:e});let o=[];for(let l in e.id&&(this.unuse(e.id),r[e.id]=[],o=r[e.id],i.set(e.id,e)),e){if(e3.has(l))continue;let i=Object.getOwnPropertyDescriptor(e,l);if("function"==typeof i.value&&(e[l]=e[l].bind(this)),i.set&&Object.defineProperty(e,l,{set:i.set.bind(this)}),i.get&&Object.defineProperty(e,l,{get:i.get.bind(this)}),e9.has(l)){let i="add"===l?()=>{u=n(e=>o.push(e),"onCurCompCleanup"),e[l](),u=null}:e[l];o.push(this.on(l,i).cancel)}else if(void 0===this[l])Object.defineProperty(this,l,{get:()=>e[l],set:i=>e[l]=i,configurable:!0,enumerable:!0}),o.push(()=>delete this[l]);else throw Error(`Duplicate component property: "${l}"`)}let l=n(()=>{if(e.require){for(let i of e.require)if(!this.c(i))throw Error(`Component "${e.id}" requires component "${i}"`)}},"checkDeps");e.destroy&&o.push(e.destroy.bind(this)),this.exists()?(l(),e.add&&(u=n(e=>o.push(e),"onCurCompCleanup"),e.add.call(this),u=null)):e.require&&o.push(this.on("add",l).cancel)},unuse(e){r[e]&&(r[e].forEach(e=>e()),delete r[e]),i.has(e)&&i.delete(e)},c:e=>i.get(e),get(e,i={}){let r=i.recursive?this.children.flatMap(n(function e(i){return[i,...i.children.flatMap(e)]},"recurse")):this.children;if(r=r.filter(i=>!e||i.is(e)),i.liveUpdate){let o=n(e=>i.recursive?this.isAncestorOf(e):e.parent===this,"isChild"),l=[];l.push(iP(i=>{o(i)&&i.is(e)&&r.push(i)})),l.push(iB(i=>{if(o(i)&&i.is(e)){let e=r.findIndex(e=>e.id===i.id);-1!==e&&r.splice(e,1)}})),this.onDestroy(()=>{for(let e of l)e.cancel()})}return r},isAncestorOf(e){return!!e.parent&&(e.parent===this||this.isAncestorOf(e.parent))},exists(){return tr.root.isAncestorOf(this)},is(e){if("*"===e)return!0;if(!Array.isArray(e))return null!=this.c(e);for(let i of e)if(!this.c(i))return!1;return!0},on(e,i){let r=o.on(e,i.bind(this));return u&&u(()=>r.cancel()),r},trigger(e,...i){o.trigger(e,...i),tr.objEvents.trigger(e,this,...i)},destroy(){this.parent&&this.parent.remove(this)},inspect(){let e={};for(let[r,n]of i)e[r]=n.inspect?n.inspect():null;return e},onAdd(e){return this.on("add",e)},onUpdate(e){return this.on("update",e)},onDraw(e){return this.on("draw",e)},onDestroy(e){return this.on("destroy",e)},clearEvents(){o.clear()}};for(let e of["onKeyPress","onKeyPressRepeat","onKeyDown","onKeyRelease","onMousePress","onMouseDown","onMouseRelease","onMouseMove","onCharInput","onMouseMove","onTouchStart","onTouchMove","onTouchEnd","onScroll","onGamepadButtonPress","onGamepadButtonDown","onGamepadButtonRelease","onGamepadStick"])f[e]=(...i)=>{let r=eM[e](...i);return l.push(r),f.onDestroy(()=>r.cancel()),r};for(let i of e)f.use(i);return f}function iR(e,i,r){return tr.objEvents[e]||(tr.objEvents[e]=new Z),tr.objEvents.on(e,(e,...n)=>{e.is(i)&&r(e,...n)})}n(iw,"dt"),n(iA,"camPos"),n(iy,"camScale"),n(iv,"camRot"),n(iV,"shake"),n(ix,"toScreen"),n(iE,"toWorld"),n(ib,"calcTransform"),n(iS,"make"),n(iR,"on");let iM=eu(e=>{let i=rR([{update:e}]);return{get paused(){return i.paused},set paused(s){i.paused=s},cancel:()=>i.destroy()}},(e,i)=>iR("update",e,i)),iT=eu(e=>{let i=rR([{draw:e}]);return{get paused(){return i.hidden},set paused(s){i.hidden=s},cancel:()=>i.destroy()}},(e,i)=>iR("draw",e,i)),iP=eu(e=>tr.events.on("add",e),(e,i)=>iR("add",e,i)),iB=eu(e=>tr.events.on("destroy",e),(e,i)=>iR("destroy",e,i));function ik(e,i,r){return iR("collide",e,(e,n,o)=>n.is(i)&&r(e,n,o))}function iF(e,i,r){return iR("collideUpdate",e,(e,n,o)=>n.is(i)&&r(e,n,o))}function iI(e,i,r){return iR("collideEnd",e,(e,n,o)=>n.is(i)&&r(e,n,o))}function iD(e,i){rP(e,{recursive:!0}).forEach(i),iP(e,i)}n(ik,"onCollide"),n(iF,"onCollideUpdate"),n(iI,"onCollideEnd"),n(iD,"forAllCurrentAndFuture");let iC=eu(e=>eM.onMousePress(e),(e,i)=>{let r=[];return iD(e,e=>{if(!e.area)throw Error("onClick() requires the object to have area() component");r.push(e.onClick(()=>i(e)))}),_.join(r)});function iU(e,i){let r=[];return iD(e,e=>{if(!e.area)throw Error("onHover() requires the object to have area() component");r.push(e.onHover(()=>i(e)))}),_.join(r)}function iN(e,i){let r=[];return iD(e,e=>{if(!e.area)throw Error("onHoverUpdate() requires the object to have area() component");r.push(e.onHoverUpdate(()=>i(e)))}),_.join(r)}function iL(e,i){let r=[];return iD(e,e=>{if(!e.area)throw Error("onHoverEnd() requires the object to have area() component");r.push(e.onHoverEnd(()=>i(e)))}),_.join(r)}function iO(e){tr.gravity=e}function iG(){return tr.gravity}function iq(...e){1===e.length||2===e.length?(ek.bgColor=v(e[0]),e[1]&&(ek.bgAlpha=e[1])):(3===e.length||4===e.length)&&(ek.bgColor=v(e[0],e[1],e[2]),e[3]&&(ek.bgAlpha=e[3])),eP.clearColor(ek.bgColor.r/255,ek.bgColor.g/255,ek.bgColor.b/255,ek.bgAlpha)}function iH(){return ek.bgColor.clone()}function iK(...e){return{id:"pos",pos:A(...e),moveBy(...e){this.pos=this.pos.add(A(...e))},move(...e){this.moveBy(A(...e).scale(iw()))},moveTo(...e){if("number"==typeof e[0]&&"number"==typeof e[1])return this.moveTo(A(e[0],e[1]),e[2]);let i=e[0],r=e[1];if(void 0===r){this.pos=A(i);return}let n=i.sub(this.pos);if(n.len()<=r*iw()){this.pos=A(i);return}this.move(n.unit().scale(r))},worldPos(){return this.parent?this.parent.transform.multVec2(this.pos):this.pos},screenPos(){let e=this.worldPos();return i0(this)?e:ix(e)},inspect(){return`(${Math.round(this.pos.x)}, ${Math.round(this.pos.y)})`},drawInspect(){t5({color:v(255,0,0),radius:4/t7()})}}}function ij(...e){return 0===e.length?ij(1):{id:"scale",scale:A(...e),scaleTo(...e){this.scale=A(...e)},scaleBy(...e){this.scale.scale(A(...e))},inspect(){return`(${iz(this.scale.x,2)}, ${iz(this.scale.y,2)})`}}}function iY(e){return{id:"rotate",angle:e??0,rotateBy(e){this.angle+=e},rotateTo(e){this.angle=e},inspect(){return`${Math.round(this.angle)}`}}}function iQ(...e){return{id:"color",color:v(...e),inspect(){return this.color.toString()}}}function iz(e,i){return Number(e.toFixed(i))}function iJ(e){return{id:"opacity",opacity:e??1,inspect(){return`${iz(this.opacity,1)}`},fadeOut(e=1,i=eJ.linear){return rF(this.opacity,0,e,e=>this.opacity=e,i)}}}function iX(e){if(!e)throw Error("Please define an anchor");return{id:"anchor",anchor:e,inspect(){return"string"==typeof this.anchor?this.anchor:this.anchor.toString()}}}function iW(e){return{id:"z",z:e,inspect(){return`${this.z}`}}}function iZ(e,i){return{id:"follow",require:["pos"],follow:{obj:e,offset:i??A(0)},add(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))},update(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))}}}function i_(e,i){let r="number"==typeof e?w.fromAngle(e):e.unit();return{id:"move",require:["pos"],update(){this.move(r.scale(i))}}}function i$(e={}){let i=e.distance??200,r=!1;return{id:"offscreen",require:["pos"],isOffScreen(){let e=this.screenPos(),r=new Q(A(0),il(),iu());return!O(r,e)&&r.sdistToPoint(e)>i*i},onExitScreen(e){return this.on("exitView",e)},onEnterScreen(e){return this.on("enterView",e)},update(){this.isOffScreen()?(r||(this.trigger("exitView"),r=!0),e.hide&&(this.hidden=!0),e.pause&&(this.paused=!0),e.destroy&&this.destroy()):(r&&(this.trigger("enterView"),r=!1),e.hide&&(this.hidden=!1),e.pause&&(this.paused=!1))}}}function i0(e){return!!e.fixed||!!e.parent&&i0(e.parent)}function i1(e={}){let i={},r=new Set;return{id:"area",collisionIgnore:e.collisionIgnore??[],add(){this.area.cursor&&this.onHover(()=>eM.setCursor(this.area.cursor)),this.onCollideUpdate((e,n)=>{i[e.id]||this.trigger("collide",e,n),i[e.id]=n,r.add(e.id)})},update(){for(let e in i)r.has(Number(e))||(this.trigger("collideEnd",i[e].target),delete i[e]);r.clear()},drawInspect(){let e=this.localArea();tz(),tY(this.area.scale),tj(this.area.offset);let i={outline:{width:4/t7(),color:v(0,0,255)},anchor:this.anchor,fill:!1,fixed:i0(this)};e instanceof Q?t$({...i,pos:e.pos,width:e.width,height:e.height}):e instanceof X?t6({...i,pts:e.pts}):e instanceof z&&t5({...i,pos:e.center,radius:e.radius}),tJ()},area:{shape:e.shape??null,scale:e.scale?A(e.scale):A(1),offset:e.offset??A(0),cursor:e.cursor??null},isClicked(){return eM.isMousePressed()&&this.isHovering()},isHovering(){let e=i0(this)?ip():iE(ip());return this.hasPoint(e)},checkCollision:e=>i[e.id]??null,getCollisions:()=>Object.values(i),isColliding:e=>!!i[e.id],isOverlapping(e){let r=i[e.id];return r&&r.hasOverlap()},onClick(e){let i=eM.onMousePress("left",()=>{this.isHovering()&&e()});return this.onDestroy(()=>i.cancel()),i},onHover(e){let i=!1;return this.onUpdate(()=>{i?i=this.isHovering():this.isHovering()&&(i=!0,e())})},onHoverUpdate(e){return this.onUpdate(()=>{this.isHovering()&&e()})},onHoverEnd(e){let i=!1;return this.onUpdate(()=>{i?this.isHovering()||(i=!1,e()):i=this.isHovering()})},onCollide(e,i){return"function"==typeof e&&void 0===i?this.on("collide",e):"string"==typeof e?this.onCollide((r,n)=>{r.is(e)&&i(r,n)}):void 0},onCollideUpdate(e,i){return"function"==typeof e&&void 0===i?this.on("collideUpdate",e):"string"==typeof e?this.on("collideUpdate",(r,n)=>r.is(e)&&i(r,n)):void 0},onCollideEnd(e,i){return"function"==typeof e&&void 0===i?this.on("collideEnd",e):"string"==typeof e?this.on("collideEnd",r=>r.is(e)&&i(r)):void 0},hasPoint(e){return j(this.worldArea(),e)},resolveCollision(e){let i=this.checkCollision(e);i&&!i.resolved&&(this.pos=this.pos.add(i.displacement),i.resolved=!0)},localArea(){return this.area.shape?this.area.shape:this.renderArea()},worldArea(){let e=this.localArea();if(!(e instanceof X||e instanceof Q))throw Error("Only support polygon and rect shapes for now");let i=this.transform.clone().scale(A(this.area.scale??1)).translate(this.area.offset);if(e instanceof Q){let r=e7(this.anchor||e_).add(1,1).scale(-.5).scale(e.width,e.height);i.translate(r)}return e.transform(i)},screenArea(){let e=this.worldArea();return i0(this)?e:e.transform(tr.cam.transform)}}}function i2(e){return{color:e.color,opacity:e.opacity,anchor:e.anchor,outline:e.outline,shader:e.shader,uniform:e.uniform}}function i5(e,i={}){let r=null,o=null,l=null,u=new $;if(!e)throw Error("Please pass the resource name or data to sprite()");let c=n((e,i,r,n)=>{let o=A(1,1);return r&&n?(o.x=r/(e.width*i.w),o.y=n/(e.height*i.h)):r?(o.x=r/(e.width*i.w),o.y=o.x):n&&(o.y=n/(e.height*i.h),o.x=o.y),o},"calcTexScale");return{id:"sprite",width:0,height:0,frame:i.frame||0,quad:i.quad||new x(0,0,1,1),animSpeed:i.animSpeed??1,flipX:i.flipX??!1,flipY:i.flipY??!1,draw(){if(!r)return;let e=r.frames[this.frame??0];if(!e)throw Error(`Frame not found: ${this.frame??0}`);if(r.slice9){let{left:n,right:o,top:l,bottom:u}=r.slice9,c=r.tex.width*e.w,f=r.tex.height*e.h,g=this.width-n-o,m=this.height-l-u,w=n/c,A=o/c,y=1-w-A,v=l/f,V=u/f,x=1-v-V,S=[E(0,0,w,v),E(w,0,y,v),E(w+y,0,A,v),E(0,v,w,x),E(w,v,y,x),E(w+y,v,A,x),E(0,v+x,w,V),E(w,v+x,y,V),E(w+y,v+x,A,V),E(0,0,n,l),E(n,0,g,l),E(n+g,0,o,l),E(0,l,n,m),E(n,l,g,m),E(n+g,l,o,m),E(0,l+m,n,u),E(n,l+m,g,u),E(n+g,l+m,o,u)];for(let n=0;n<9;n++){let o=S[n],l=S[n+9];tW(Object.assign(i2(this),{pos:l.pos(),tex:r.tex,quad:e.scale(o),flipX:this.flipX,flipY:this.flipY,tiled:i.tiled,width:l.w,height:l.h}))}}else tW(Object.assign(i2(this),{tex:r.tex,quad:e.scale(this.quad??new x(0,0,1,1)),flipX:this.flipX,flipY:this.flipY,tiled:i.tiled,width:this.width,height:this.height}))},add(){let o=n(e=>{let n=e.frames[0].clone();i.quad&&(n=n.scale(i.quad));let o=c(e.tex,n,i.width,i.height);this.width=e.tex.width*n.w*o.x,this.height=e.tex.height*n.h*o.y,i.anim&&this.play(i.anim),r=e,u.trigger(r)},"setSpriteData"),l=tM(e);l?l.onLoad(o):rc(()=>o(tM(e).data))},update(){if(!o)return;let e=r.anims[o.name];if("number"==typeof e){this.frame=e;return}if(0===e.speed)throw Error("Sprite anim speed cannot be 0");o.timer+=iw()*this.animSpeed,o.timer>=1/o.speed&&(o.timer=0,this.frame+=l,(this.frame<Math.min(e.from,e.to)||this.frame>Math.max(e.from,e.to))&&(o.loop?o.pingpong?(this.frame-=l,l*=-1,this.frame+=l):this.frame=e.from:(this.frame=e.to,o.onEnd(),this.stop())))},play(e,i={}){if(!r){u.add(()=>this.play(e,i));return}let n=r.anims[e];if(void 0===n)throw Error(`Anim not found: ${e}`);o&&this.stop(),o="number"==typeof n?{name:e,timer:0,loop:!1,pingpong:!1,speed:0,onEnd:()=>{}}:{name:e,timer:0,loop:i.loop??n.loop??!1,pingpong:i.pingpong??n.pingpong??!1,speed:i.speed??n.speed??10,onEnd:i.onEnd??(()=>{})},l="number"==typeof n?null:n.from<n.to?1:-1,this.frame="number"==typeof n?n:n.from,this.trigger("animStart",e)},stop(){if(!o)return;let e=o.name;o=null,this.trigger("animEnd",e)},numFrames:()=>r?.frames.length??0,curAnim:()=>o?.name,onAnimEnd(e){return this.on("animEnd",e)},onAnimStart(e){return this.on("animStart",e)},renderArea(){return new Q(A(0),this.width,this.height)},inspect(){if("string"==typeof e)return`"${e}"`}}}function i4(e,i={}){function r(e){let r=io(Object.assign(i2(e),{text:e.text+"",size:e.textSize,font:e.font,width:i.width&&e.width,align:e.align,letterSpacing:e.letterSpacing,lineSpacing:e.lineSpacing,transform:e.textTransform,styles:e.textStyles}));return i.width||(e.width=r.width/(e.scale?.x||1)),e.height=r.height/(e.scale?.y||1),r}n(r,"update");let o={id:"text",set text(a){e=a,r(this)},get text(){return e},textSize:i.size??36,font:i.font,width:i.width??0,height:0,align:i.align,lineSpacing:i.lineSpacing,letterSpacing:i.letterSpacing,textTransform:i.transform,textStyles:i.styles,add(){rc(()=>r(this))},draw(){ih(r(this))},renderArea(){return new Q(A(0),this.width,this.height)}};return r(o),o}function i6(e,i={}){if(e.length<3)throw Error(`Polygon's need more than two points, ${e.length} points provided`);return{id:"polygon",pts:e,colors:i.colors,radius:i.radius,draw(){t6(Object.assign(i2(this),{pts:this.pts,colors:this.colors,radius:this.radius,fill:i.fill}))},renderArea(){return new X(this.pts)},inspect(){return this.pts.map(e=>`[${e.x},${e.y}]`).join(",")}}}function i8(e,i,r={}){return{id:"rect",width:e,height:i,radius:r.radius||0,draw(){t$(Object.assign(i2(this),{width:this.width,height:this.height,radius:this.radius,fill:r.fill}))},renderArea(){return new Q(A(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}function i3(e,i){return{id:"rect",width:e,height:i,draw(){tX(Object.assign(i2(this),{width:this.width,height:this.height}))},renderArea(){return new Q(A(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}function i9(e,i={}){return{id:"circle",radius:e,draw(){t5(Object.assign(i2(this),{radius:this.radius,fill:i.fill}))},renderArea(){return new Q(new w(this.anchor?0:-this.radius),2*this.radius,2*this.radius)},inspect(){return`${Math.ceil(this.radius)}`}}}function i7(e=1,i=v(0,0,0)){return{id:"outline",outline:{width:e,color:i}}}function re(){return{id:"timer",wait(e,i){let r=[];i&&r.push(i);let n=0,o=this.onUpdate(()=>{(n+=iw())>=e&&(r.forEach(e=>e()),o.cancel())});return{get paused(){return o.paused},set paused(h){o.paused=h},cancel:o.cancel,onEnd(e){r.push(e)},then(e){return this.onEnd(e),this}}},loop(e,i){let r=null,o=n(()=>{r=this.wait(e,o),i()},"newAction");return r=this.wait(0,o),{get paused(){return r.paused},set paused(a){r.paused=a},cancel:()=>r.cancel()}},tween(e,i,r,n,o=eJ.linear){let l=0,u=[],c=this.onUpdate(()=>{let g=Math.min((l+=iw())/r,1);n(f(e,i,o(g))),1===g&&(c.cancel(),n(i),u.forEach(e=>e()))});return{get paused(){return c.paused},set paused(p){c.paused=p},onEnd(e){u.push(e)},then(e){return this.onEnd(e),this},cancel(){c.cancel()},finish(){c.cancel(),n(i),u.forEach(e=>e())}}}}}function rt(e={}){let i=null,r=null,n=!1;return{id:"body",require:["pos","area"],vel:new w(0),jumpForce:e.jumpForce??640,gravityScale:e.gravityScale??1,isStatic:e.isStatic??!1,mass:e.mass??1,add(){if(0===this.mass)throw Error("Can't set body mass to 0");this.onCollideUpdate((e,i)=>{if(e.is("body")&&!i.resolved&&(this.trigger("beforePhysicsResolve",i),e.trigger("beforePhysicsResolve",i.reverse()),!i.resolved&&!(this.isStatic&&e.isStatic))){if(this.isStatic||e.isStatic){let r=!this.isStatic&&e.isStatic?i:i.reverse();r.source.pos=r.source.pos.add(r.displacement),r.source.transform=ib(r.source)}else{let r=this.mass+e.mass;this.pos=this.pos.add(i.displacement.scale(e.mass/r)),e.pos=e.pos.add(i.displacement.scale(-this.mass/r)),this.transform=ib(this),e.transform=ib(e)}i.resolved=!0,this.trigger("physicsResolve",i),e.trigger("physicsResolve",i.reverse())}}),this.onPhysicsResolve(e=>{tr.gravity&&(e.isBottom()&&this.isFalling()?(this.vel.y=0,i=e.target,r=e.target.pos,n?n=!1:this.trigger("ground",i)):e.isTop()&&this.isJumping()&&(this.vel.y=0,this.trigger("headbutt",e.target)))})},update(){if(!tr.gravity||this.isStatic)return;if(n&&(i=null,r=null,this.trigger("fallOff"),n=!1),i){if(this.isColliding(i)&&i.exists()&&i.is("body")){i.pos.eq(r)||!1===e.stickToPlatform||this.moveBy(i.pos.sub(r)),r=i.pos;return}n=!0}let o=this.vel.y;this.vel.y+=tr.gravity*this.gravityScale*iw(),this.vel.y=Math.min(this.vel.y,e.maxVelocity??65536),o<0&&this.vel.y>=0&&this.trigger("fall"),this.move(this.vel)},onPhysicsResolve(e){return this.on("physicsResolve",e)},onBeforePhysicsResolve(e){return this.on("beforePhysicsResolve",e)},curPlatform:()=>i,isGrounded:()=>null!==i,isFalling(){return this.vel.y>0},isJumping(){return this.vel.y<0},jump(e){i=null,r=null,this.vel.y=-e||-this.jumpForce},onGround(e){return this.on("ground",e)},onFall(e){return this.on("fall",e)},onFallOff(e){return this.on("fallOff",e)},onHeadbutt(e){return this.on("headbutt",e)}}}function ri(e=2){let i=e;return{id:"doubleJump",require:["body"],numJumps:e,add(){this.onGround(()=>{i=this.numJumps})},doubleJump(e){i<=0||(i<this.numJumps&&this.trigger("doubleJump"),i--,this.jump(e))},onDoubleJump(e){return this.on("doubleJump",e)},inspect:()=>`${i}`}}function rr(e,i){return{id:"shader",shader:e,..."function"==typeof i?{uniform:i(),update(){this.uniform=i()}}:{uniform:i}}}function rn(){return{id:"fixed",fixed:!0}}function rs(e){return{id:"stay",stay:!0,scenesToStay:e}}function ro(e,i){if(null==e)throw Error("health() requires the initial amount of hp");return{id:"health",hurt(i=1){this.setHP(e-i),this.trigger("hurt",i)},heal(i=1){let r=e;this.setHP(e+i),this.trigger("heal",e-r)},hp:()=>e,maxHP:()=>i??null,setMaxHP(e){i=e},setHP(r){(e=i?Math.min(i,r):r)<=0&&this.trigger("death")},onHurt(e){return this.on("hurt",e)},onHeal(e){return this.on("heal",e)},onDeath(e){return this.on("death",e)},inspect:()=>`${e}`}}function ra(e,i={}){if(null==e)throw Error("lifespan() requires time");let r=i.fade??0;return{id:"lifespan",async add(){await rB(e),r>0&&this.opacity&&await rF(this.opacity,0,r,e=>this.opacity=e,eJ.linear),this.destroy()}}}function rh(e,i,r){if(!e)throw Error("state() requires an initial state");let o={};function l(e){o[e]||(o[e]={enter:new $,end:new $,update:new $,draw:new $})}function u(e,i,r){return l(i),o[i][e].add(r)}function c(e,i,...r){l(i),o[i][e].trigger(...r)}n(l,"initStateEvents"),n(u,"on"),n(c,"trigger");let f=!1;return{id:"state",state:e,enterState(e,...n){if(f=!0,i&&!i.includes(e))throw Error(`State not found: ${e}`);let o=this.state;if(r){if(!r?.[o])return;let i="string"==typeof r[o]?[r[o]]:r[o];if(!i.includes(e))throw Error(`Cannot transition state from "${o}" to "${e}". Available transitions: ${i.map(e=>`"${e}"`).join(", ")}`)}c("end",o,...n),this.state=e,c("enter",e,...n),c("enter",`${o} -> ${e}`,...n)},onStateTransition:(e,i,r)=>u("enter",`${e} -> ${i}`,r),onStateEnter:(e,i)=>u("enter",e,i),onStateUpdate:(e,i)=>u("update",e,i),onStateDraw:(e,i)=>u("draw",e,i),onStateEnd:(e,i)=>u("end",e,i),update(){f||(c("enter",e),f=!0),c("update",this.state)},draw(){c("draw",this.state)},inspect(){return this.state}}}function rl(e=1){let i=0,r=!1;return{require:["opacity"],add(){this.opacity=0},update(){r||(i+=iw(),this.opacity=g(i,0,e,0,1),i>=e&&(this.opacity=1,r=!0))}}}function ru(e="intersect"){return{id:"mask",mask:e}}function rd(e){return{add(){this.canvas=e}}}function rc(e){ez.loaded?e():tr.events.on("load",e)}function rf(e,i){tr.scenes[e]=i}function rp(e,...i){if(!tr.scenes[e])throw Error(`Scene not found: ${e}`);tr.events.onOnce("frameEnd",()=>{tr.events.trigger("sceneLeave",e),eM.events.clear(),tr.events.clear(),tr.objEvents.clear(),[...tr.root.children].forEach(i=>{i.stay&&(!i.scenesToStay||i.scenesToStay.includes(e))||tr.root.remove(i)}),tr.root.clearEvents(),r_(),tr.cam={pos:null,scale:A(1),angle:0,shake:0,transform:new S},tr.scenes[e](...i)})}function rg(e){return tr.events.on("sceneLeave",e)}function rm(e,i){try{return JSON.parse(window.localStorage[e])}catch{return i?(rw(e,i),i):null}}function rw(e,i){window.localStorage[e]=JSON.stringify(i)}function rA(i,...r){let n=i(r$),o;for(let i in o="function"==typeof n?n(...r)(r$):n)r$[i]=o[i],!1!==e.global&&(window[i]=o[i]);return r$}function ry(){return A(il()/2,iu()/2)}function rv(e={}){let i=A(0),r=e.isObstacle??!1,o=e.cost??0,l=e.edges??[],u=n(()=>{let e={left:1,top:2,right:4,bottom:8};return l.map(i=>e[i]||0).reduce((e,i)=>e|i,0)},"getEdgeMask"),c=u();return{id:"tile",tilePosOffset:e.offset??A(0),set tilePos(b){let e=this.getLevel();i=b.clone(),this.pos=A(this.tilePos.x*e.tileWidth(),this.tilePos.y*e.tileHeight()).add(this.tilePosOffset)},get tilePos(){return i},set isObstacle(b){r!==b&&(r=b,this.getLevel().invalidateNavigationMap())},get isObstacle(){return r},set cost(b){o!==b&&(o=b,this.getLevel().invalidateNavigationMap())},get cost(){return o},set edges(b){l=b,c=u(),this.getLevel().invalidateNavigationMap()},get edges(){return l},get edgeMask(){return c},getLevel(){return this.parent},moveLeft(){this.tilePos=this.tilePos.add(A(-1,0))},moveRight(){this.tilePos=this.tilePos.add(A(1,0))},moveUp(){this.tilePos=this.tilePos.add(A(0,-1))},moveDown(){this.tilePos=this.tilePos.add(A(0,1))}}}function rV(e,i){if(!i.tileWidth||!i.tileHeight)throw Error("Must provide tileWidth and tileHeight.");let r=rR([iK(i.pos??A(0))]),o=e.length,l=0,u=null,c=null,f=null,g=null,m=n(e=>e.x+e.y*l,"tile2Hash"),w=n(e=>A(Math.floor(e%l),Math.floor(e/l)),"hash2Tile"),y=n(()=>{for(let e of(u=[],r.children))v(e)},"createSpatialMap"),v=n(e=>{let i=m(e.tilePos);u[i]?u[i].push(e):u[i]=[e]},"insertIntoSpatialMap"),V=n(e=>{let i=m(e.tilePos);if(u[i]){let r=u[i].indexOf(e);r>=0&&u[i].splice(r,1)}},"removeFromSpatialMap"),x=n(()=>{let e=!1;for(let i of r.children){let n=r.pos2Tile(i.pos);(i.tilePos.x!=n.x||i.tilePos.y!=n.y)&&(e=!0,V(i),i.tilePos.x=n.x,i.tilePos.y=n.y,v(i))}e&&r.trigger("spatial_map_changed")},"updateSpatialMap"),E=n(()=>{let e=r.getSpatialMap(),i=r.numRows()*r.numColumns();c?c.length=i:c=Array(i),c.fill(1,0,i);for(let i=0;i<e.length;i++){let r=e[i];if(r){let e=0;for(let i of r)if(i.isObstacle){e=1/0;break}else e+=i.cost;c[i]=e||1}}},"createCostMap"),S=n(()=>{let e=r.getSpatialMap(),i=r.numRows()*r.numColumns();f?f.length=i:f=Array(i),f.fill(15,0,i);for(let i=0;i<e.length;i++){let r=e[i];if(r){let e=r.length,n=15;for(let i=0;i<e;i++)n|=r[i].edgeMask;f[i]=n}}},"createEdgeMap"),R=n(()=>{let e=r.numRows()*r.numColumns(),i=n((e,i)=>{let r=[];for(r.push(e);r.length>0;)B(r.pop()).forEach(e=>{g[e]<0&&(g[e]=i,r.push(e))})},"traverse");g?g.length=e:g=Array(e),g.fill(-1,0,e);let o=0;for(let e=0;e<c.length;e++){if(g[e]>=0){o++;continue}i(e,o),o++}},"createConnectivityMap"),T=n((e,i)=>c[i],"getCost"),P=n((e,i)=>{let r=w(e),n=w(i);return r.dist(n)},"getHeuristic"),B=n((e,i)=>{let r=[],n=Math.floor(e%l),u=n>0&&1&f[e]&&c[e-1]!==1/0,g=e>=l&&2&f[e]&&c[e-l]!==1/0,m=n<l-1&&4&f[e]&&c[e+1]!==1/0,w=e<l*o-l-1&&8&f[e]&&c[e+l]!==1/0;return i?(u&&(g&&r.push(e-l-1),r.push(e-1),w&&r.push(e+l-1)),g&&r.push(e-l),m&&(g&&r.push(e-l+1),r.push(e+1),w&&r.push(e+l+1))):(u&&r.push(e-1),g&&r.push(e-l),m&&r.push(e+1)),w&&r.push(e+l),r},"getNeighbours");return r.use({id:"level",tileWidth:()=>i.tileWidth,tileHeight:()=>i.tileHeight,spawn(e,...n){let o=A(...n),l=(()=>{if("string"==typeof e){if(i.tiles[e]){if("function"!=typeof i.tiles[e])throw Error("Level symbol def must be a function returning a component list");return i.tiles[e](o)}if(i.wildcardTile)return i.wildcardTile(e,o)}else{if(Array.isArray(e))return e;throw Error("Expected a symbol or a component list")}})();if(!l)return null;let c=!1,f=!1;for(let e of l)"tile"===e.id&&(f=!0),"pos"===e.id&&(c=!0);c||l.push(iK()),f||l.push(rv());let g=r.add(l);return c&&(g.tilePosOffset=g.pos.clone()),g.tilePos=o,u&&(v(g),this.trigger("spatial_map_changed"),this.trigger("navigation_map_invalid")),g},numColumns:()=>l,numRows:()=>o,levelWidth(){return l*this.tileWidth()},levelHeight(){return o*this.tileHeight()},tile2Pos(...e){return A(...e).scale(this.tileWidth(),this.tileHeight())},pos2Tile(...e){let i=A(...e);return A(Math.floor(i.x/this.tileWidth()),Math.floor(i.y/this.tileHeight()))},getSpatialMap:()=>(u||y(),u),onSpatialMapChanged(e){return this.on("spatial_map_changed",e)},onNavigationMapInvalid(e){return this.on("navigation_map_invalid",e)},getAt:e=>(u||y(),u[m(e)]||[]),update(){u&&x()},invalidateNavigationMap(){c=null,f=null,g=null},onNavigationMapChanged(e){return this.on("navigation_map_changed",e)},getTilePath(e,i,r={}){if(c||E(),f||S(),g||R(),e.x<0||e.x>=l||e.y<0||e.y>=o||i.x<0||i.x>=l||i.y<0||i.y>=o)return null;let n=m(e),u=m(i);if(c[u]===1/0)return null;if(n===u)return[];if(-1!=g[n]&&g[n]!==g[u])return null;let A=new ef((e,i)=>e.cost<i.cost);A.insert({cost:0,node:n});let y=new Map;y.set(n,n);let v=new Map;for(v.set(n,0);0!==A.length;){let e=A.remove()?.node;if(e===u)break;for(let i of B(e,r.allowDiagonals)){let r=(v.get(e)||0)+T(e,i)+P(i,u);(!v.has(i)||r<v.get(i))&&(v.set(i,r),A.insert({cost:r,node:i}),y.set(i,e))}}let V=[],x=u,k=w(x);for(V.push(k);x!==n;){let e=w(x=y.get(x));V.push(e)}return V.reverse()},getPath(e,i,r={}){let n=this.tileWidth(),o=this.tileHeight(),l=this.getTilePath(this.pos2Tile(e),this.pos2Tile(i),r);return l?[e,...l.slice(1,-1).map(e=>e.scale(n,o).add(n/2,o/2)),i]:null}}),r.onNavigationMapInvalid(()=>{r.invalidateNavigationMap(),r.trigger("navigation_map_changed")}),e.forEach((e,i)=>{let n=e.split("");l=Math.max(n.length,l),n.forEach((e,n)=>{r.spawn(e,A(n,i))})}),r}function rx(e={}){let i=null,r=null,n=null,o=null;return{id:"agent",require:["pos","tile"],agentSpeed:e.speed??100,allowDiagonals:e.allowDiagonals??!0,getDistanceToTarget(){return i?this.pos.dist(i):0},getNextLocation:()=>r&&n?r[n]:null,getPath:()=>r?r.slice():null,getTarget:()=>i,isNavigationFinished:()=>!r||null===n,isTargetReachable:()=>null!==r,isTargetReached(){return!i||this.pos.eq(i)},setTarget(e){i=e,n=(r=this.getLevel().getPath(this.pos,i,{allowDiagonals:this.allowDiagonals}))?0:null,r?(o||(o=this.getLevel().onNavigationMapChanged(()=>{r&&null!==n&&(n=(r=this.getLevel().getPath(this.pos,i,{allowDiagonals:this.allowDiagonals}))?0:null,r?this.trigger("navigation-next",this,r[n]):this.trigger("navigation-ended",this))}),this.onDestroy(()=>o.cancel())),this.trigger("navigation-started",this),this.trigger("navigation-next",this,r[n])):this.trigger("navigation-ended",this)},update(){if(r&&null!==n){if(2>this.pos.sdist(r[n])){if(n===r.length-1){this.pos=i.clone(),n=null,this.trigger("navigation-ended",this),this.trigger("target-reached",this);return}n++,this.trigger("navigation-next",this,r[n])}this.moveTo(r[n],this.agentSpeed)}},onNavigationStarted(e){return this.on("navigation-started",e)},onNavigationNext(e){return this.on("navigation-next",e)},onNavigationEnded(e){return this.on("navigation-ended",e)},onTargetReached(e){return this.on("target-reached",e)},inspect:()=>JSON.stringify({target:JSON.stringify(i),path:JSON.stringify(r)})}}function rE(e){let i=eM.canvas.captureStream(e),r=eQ.ctx.createMediaStreamDestination();eQ.masterNode.connect(r);let n=new MediaRecorder(i),o=[];return n.ondataavailable=e=>{e.data.size>0&&o.push(e.data)},n.onerror=()=>{eQ.masterNode.disconnect(r),i.getTracks().forEach(e=>e.stop())},n.start(),{resume(){n.resume()},pause(){n.pause()},stop:()=>(n.stop(),eQ.masterNode.disconnect(r),i.getTracks().forEach(e=>e.stop()),new Promise(e=>{n.onstop=()=>{e(new Blob(o,{type:"video/mp4"}))}})),download(e="kaboom.mp4"){this.stop().then(i=>ea(e,i))}}}function rb(){return document.activeElement===eM.canvas}function rS(e){e.destroy()}n(iU,"onHover"),n(iN,"onHoverUpdate"),n(iL,"onHoverEnd"),n(iO,"setGravity"),n(iG,"getGravity"),n(iq,"setBackground"),n(iH,"getBackground"),n(iK,"pos"),n(ij,"scale"),n(iY,"rotate"),n(iQ,"color"),n(iz,"toFixed"),n(iJ,"opacity"),n(iX,"anchor"),n(iW,"z"),n(iZ,"follow"),n(i_,"move"),n(i$,"offscreen"),n(i0,"isFixed"),n(i1,"area"),n(i2,"getRenderProps"),n(i5,"sprite"),n(i4,"text"),n(i6,"polygon"),n(i8,"rect"),n(i3,"uvquad"),n(i9,"circle"),n(i7,"outline"),n(re,"timer"),n(rt,"body"),n(ri,"doubleJump"),n(rr,"shader"),n(rn,"fixed"),n(rs,"stay"),n(ro,"health"),n(ra,"lifespan"),n(rh,"state"),n(rl,"fadeIn"),n(ru,"mask"),n(rd,"drawon"),n(rc,"onLoad"),n(rf,"scene"),n(rp,"go"),n(rg,"onSceneLeave"),n(rm,"getData"),n(rw,"setData"),n(rA,"plug"),n(ry,"center"),(ew=eA||={})[ew.None=0]="None",ew[ew.Left=1]="Left",ew[ew.Top=2]="Top",ew[ew.LeftTop=3]="LeftTop",ew[ew.Right=4]="Right",ew[ew.Horizontal=5]="Horizontal",ew[ew.RightTop=6]="RightTop",ew[ew.HorizontalTop=7]="HorizontalTop",ew[ew.Bottom=8]="Bottom",ew[ew.LeftBottom=9]="LeftBottom",ew[ew.Vertical=10]="Vertical",ew[ew.LeftVertical=11]="LeftVertical",ew[ew.RightBottom=12]="RightBottom",ew[ew.HorizontalBottom=13]="HorizontalBottom",ew[ew.RightVertical=14]="RightVertical",ew[ew.All=15]="All",n(rv,"tile"),n(rV,"addLevel"),n(rx,"agent"),n(rE,"record"),n(rb,"isFocused"),n(rS,"destroy");let rR=tr.root.add.bind(tr.root),rM=tr.root.readd.bind(tr.root),rT=tr.root.removeAll.bind(tr.root),rP=tr.root.get.bind(tr.root),rB=tr.root.wait.bind(tr.root),rk=tr.root.loop.bind(tr.root),rF=tr.root.tween.bind(tr.root);function rI(e=2,i=1){let r=0;return{require:["scale"],update(){let n=Math.sin(r*e)*i;n<0&&this.destroy(),this.scale=A(n),r+=iw()}}}n(rI,"boom");let rD=tp(null,"data:image/png;base64,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"),rC=tp(null,"data:image/png;base64,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");function rU(e,i={}){let r=rR([iK(e),rs()]),n=5*(i.speed||1),o=i.scale||1;r.add([i5(rC),ij(0),iX("center"),rI(n,o),...i.comps??[]]);let l=r.add([i5(rD),ij(0),iX("center"),re(),...i.comps??[]]);return l.wait(.4/n,()=>l.use(rI(n,o))),l.onDestroy(()=>r.destroy()),r}function rN(){tr.root.update()}n(rU,"addKaboom"),n(rN,"updateFrame");class rL{static{n(this,"Collision")}source;target;displacement;resolved=!1;constructor(e,i,r,n=!1){this.source=e,this.target=i,this.displacement=r,this.resolved=n}reverse(){return new rL(this.target,this.source,this.displacement.scale(-1),this.resolved)}hasOverlap(){return!this.displacement.isZero()}isLeft(){return this.displacement.x>0}isRight(){return this.displacement.x<0}isTop(){return this.displacement.y>0}isBottom(){return this.displacement.y<0}preventResolution(){this.resolved=!0}}function rO(){let i={},r=e.hashGridSize||64,o=new S,l=[];function u(e){if(l.push(o.clone()),e.pos&&o.translate(e.pos),e.scale&&o.scale(e.scale),e.angle&&o.rotate(e.angle),e.transform=o.clone(),e.c("area")&&!e.paused){let n=e.worldArea().bbox(),o=Math.floor(n.pos.x/r),l=Math.floor(n.pos.y/r),u=Math.ceil((n.pos.x+n.width)/r),c=Math.ceil((n.pos.y+n.height)/r),f=new Set;for(let r=o;r<=u;r++)for(let n=l;n<=c;n++)if(i[r]){if(i[r][n]){let o=i[r][n];e:for(let i of o){if(i.paused||!i.exists()||f.has(i.id))continue;for(let r of e.collisionIgnore)if(i.is(r))continue e;for(let r of i.collisionIgnore)if(e.is(r))continue e;let r=W(e.worldArea(),i.worldArea());if(r){let n=new rL(e,i,r);e.trigger("collideUpdate",i,n);let o=n.reverse();o.resolved=n.resolved,i.trigger("collideUpdate",e,o)}f.add(i.id)}o.push(e)}else i[r][n]=[e]}else i[r]={},i[r][n]=[e]}e.children.forEach(u),o=l.pop()}n(u,"checkObj"),u(tr.root)}function rG(){let e=tr.cam,i=w.fromAngle(k(0,360)).scale(e.shake);e.shake=f(e.shake,0,5*iw()),e.transform=new S().translate(ry()).scale(e.scale).rotate(e.angle).translate((e.pos??ry()).scale(-1).add(i)),tr.root.draw(),tL()}function rq(){let e=ts();tr.events.numListeners("loading")>0?tr.events.trigger("loading",e):ie(()=>{let i=il()/2,r=A(il()/2,iu()/2).sub(A(i/2,12));t$({pos:A(0),width:il(),height:iu(),color:v(0,0,0)}),t$({pos:r,width:i,height:24,fill:!1,outline:{width:4}}),t$({pos:r,width:i*e,height:24})})}function rH(e,i){ie(()=>{let r=A(8);tz(),tj(e);let n=io({text:i,font:e$,size:16,pos:r,color:v(255,255,255),fixed:!0}),o=n.width+2*r.x,l=n.height+2*r.x;e.x+o>=il()&&tj(A(-o,0)),e.y+l>=iu()&&tj(A(0,-l)),t$({width:o,height:l,color:v(0,0,0),radius:4,opacity:.8,fixed:!0}),ih(n),tJ()})}function rK(){if(im.inspect){let e=null;for(let i of tr.root.get("*",{recursive:!0}))if(i.c("area")&&i.isHovering()){e=i;break}if(tr.root.drawInspect(),e){let i=[],r=e.inspect();for(let e in r)r[e]?i.push(`${e}: ${r[e]}`):i.push(`${e}`);rH(ic(ip()),i.join(`
`))}rH(A(8),`FPS: ${im.fps()}`)}im.paused&&ie(()=>{tz(),tj(il(),0),tj(-8,8),t$({width:32,height:32,anchor:"topright",color:v(0,0,0),opacity:.8,radius:4,fixed:!0});for(let e=1;e<=2;e++)t$({width:4,height:19.2,anchor:"center",pos:A(-32/3*e,16),color:v(255,255,255),radius:2,fixed:!0});tJ()}),1!==im.timeScale&&ie(()=>{tz(),tj(il(),iu()),tj(-8,-8);let e=io({text:im.timeScale.toFixed(1),font:e$,size:16,color:v(255,255,255),pos:A(-8),anchor:"botright",fixed:!0});t$({width:e.width+16+32,height:e.height+16,anchor:"botright",color:v(0,0,0),opacity:.8,radius:4,fixed:!0});for(let i=0;i<2;i++){let r=im.timeScale<1;t2({p1:A(-e.width-8*(r?2:3.5),-8),p2:A(-e.width-8*(r?2:3.5),-8-e.height),p3:A(-e.width-8*(r?3.5:2),-8-e.height/2),pos:A(-(8*i)+(r?-4:0),0),color:v(255,255,255),fixed:!0})}ih(e),tJ()}),im.curRecording&&ie(()=>{tz(),tj(0,iu()),tj(24,-24),t5({radius:12,color:v(255,0,0),opacity:R(0,1,4*eM.time()),fixed:!0}),tJ()}),im.showLog&&tr.logs.length>0&&ie(()=>{tz(),tj(0,iu()),tj(8,-8);let i=[];for(let e of tr.logs){let r="",n=e.msg instanceof Error?"error":"info";r+=`[time]${e.time.toFixed(2)}[/time] [${n}]${e.msg?.toString?e.msg.toString():e.msg}[/${n}]`,i.push(r)}tr.logs=tr.logs.filter(i=>eM.time()-i.time<(e.logTime||4));let r=io({text:i.join(`
`),font:e$,pos:A(8,-8),anchor:"botleft",size:16,width:.6*il(),lineSpacing:4,fixed:!0,styles:{time:{color:v(127,127,127)},info:{color:v(255,255,255)},error:{color:v(255,0,127)}}});t$({width:r.width+16,height:r.height+16,anchor:"botleft",color:v(0,0,0),radius:4,opacity:.8,fixed:!0}),ih(r),tJ()})}function rj(e){tr.events.on("loading",e)}function rY(e){eM.onResize(e)}function rQ(e){tr.events.on("error",e)}function rz(e){console.error(e),eQ.ctx.suspend(),eM.run(()=>{tO(),ie(()=>{let i=il(),r=iu(),n={size:36,width:i-64,letterSpacing:4,lineSpacing:4,font:e$,fixed:!0};t$({width:i,height:r,color:v(0,0,255),fixed:!0});let o=io({...n,text:"Error",pos:A(32),color:v(255,128,0),fixed:!0});ih(o),ia({...n,text:e.message,pos:A(32,32+o.height+16),fixed:!0}),tJ(),tr.events.trigger("error",e)}),tq()})}function rJ(e){eT.push(e)}function rX(){tr.events.onOnce("frameEnd",()=>{eM.quit(),eP.clear(eP.COLOR_BUFFER_BIT|eP.DEPTH_BUFFER_BIT|eP.STENCIL_BUFFER_BIT);let e=eP.getParameter(eP.MAX_TEXTURE_IMAGE_UNITS);for(let i=0;i<e;i++)eP.activeTexture(eP.TEXTURE0+i),eP.bindTexture(eP.TEXTURE_2D,null),eP.bindTexture(eP.TEXTURE_CUBE_MAP,null);eP.bindBuffer(eP.ARRAY_BUFFER,null),eP.bindBuffer(eP.ELEMENT_ARRAY_BUFFER,null),eP.bindRenderbuffer(eP.RENDERBUFFER,null),eP.bindFramebuffer(eP.FRAMEBUFFER,null),eB.destroy(),eT.forEach(e=>e())})}n(rO,"checkFrame"),n(rG,"drawFrame"),n(rq,"drawLoadScreen"),n(rH,"drawInspectText"),n(rK,"drawDebug"),n(rj,"onLoading"),n(rY,"onResize"),n(rQ,"onError"),n(rz,"handleErr"),n(rJ,"onCleanup"),n(rX,"quit");let rW=!0;function rZ(){let i=eP.drawingBufferWidth/eb,r=eP.drawingBufferHeight/eb;if(e.letterbox){if(!e.width||!e.height)throw Error("Letterboxing requires width and height defined.");let n=i/r,o=e.width/e.height;if(n>o){let e=r*o;ek.viewport={x:(i-e)/2,y:0,width:e,height:r}}else{let e=i/o;ek.viewport={x:0,y:(r-e)/2,width:i,height:e}}return}if(e.stretch&&(!e.width||!e.height))throw Error("Stretching requires width and height defined.");ek.viewport={x:0,y:0,width:i,height:r}}function r_(){eM.onHide(()=>{e.backgroundAudio||eQ.ctx.suspend()}),eM.onShow(()=>{e.backgroundAudio||im.paused||eQ.ctx.resume()}),eM.onResize(()=>{if(eM.isFullscreen())return;let i=e.width&&e.height;i&&!e.stretch&&!e.letterbox||(ev.width=ev.offsetWidth*eb,ev.height=ev.offsetHeight*eb,rZ(),i||(ek.frameBuffer.free(),ek.frameBuffer=new eD(eB,eP.drawingBufferWidth,eP.drawingBufferHeight),ek.width=eP.drawingBufferWidth/eb,ek.height=eP.drawingBufferHeight/eb))}),!1!==e.debug&&(eM.onKeyPress("f1",()=>im.inspect=!im.inspect),eM.onKeyPress("f2",()=>im.clearLog()),eM.onKeyPress("f8",()=>im.paused=!im.paused),eM.onKeyPress("f7",()=>{im.timeScale=iz(c(im.timeScale-.2,0,2),1)}),eM.onKeyPress("f9",()=>{im.timeScale=iz(c(im.timeScale+.2,0,2),1)}),eM.onKeyPress("f10",()=>im.stepFrame())),e.burp&&eM.onKeyPress("b",()=>tI())}eM.run(()=>{try{ez.loaded||1!==ts()||rW||(ez.loaded=!0,tr.events.trigger("load")),!ez.loaded&&!1!==e.loadingScreen||rW?(tO(),rq()):(im.paused||rN(),rO(),tO(),rG(),!1!==e.debug&&rK()),tq(),rW&&(rW=!1),tr.events.trigger("frameEnd")}catch(e){rz(e)}}),n(rZ,"updateViewport"),n(r_,"initEvents"),rZ(),r_();let r$={VERSION:"3000.1.17",loadRoot:to,loadProgress:ts,loadSprite:tp,loadSpriteAtlas:tc,loadSound:ty,loadBitmapFont:tu,loadFont:tl,loadShader:tw,loadShaderURL:tA,loadAseprite:tm,loadPedit:tg,loadBean:tv,loadJSON:ta,load:tn,getSprite:tV,getSound:tx,getFont:tE,getBitmapFont:tb,getShader:tS,getAsset:tR,Asset:eO,SpriteData:eN,SoundData:eq,width:il,height:iu,center:ry,dt:iw,time:eM.time,screenshot:eM.screenshot,record:rE,isFocused:rb,setCursor:eM.setCursor,getCursor:eM.getCursor,setCursorLocked:eM.setCursorLocked,isCursorLocked:eM.isCursorLocked,setFullscreen:eM.setFullscreen,isFullscreen:eM.isFullscreen,isTouchscreen:eM.isTouchscreen,onLoad:rc,onLoading:rj,onResize:rY,onGamepadConnect:eM.onGamepadConnect,onGamepadDisconnect:eM.onGamepadDisconnect,onError:rQ,onCleanup:rJ,camPos:iA,camScale:iy,camRot:iv,shake:iV,toScreen:ix,toWorld:iE,setGravity:iO,getGravity:iG,setBackground:iq,getBackground:iH,getGamepads:eM.getGamepads,add:rR,make:iS,destroy:rS,destroyAll:rT,get:rP,readd:rM,pos:iK,scale:ij,rotate:iY,color:iQ,opacity:iJ,anchor:iX,area:i1,sprite:i5,text:i4,polygon:i6,rect:i8,circle:i9,uvquad:i3,outline:i7,body:rt,doubleJump:ri,shader:rr,timer:re,fixed:rn,stay:rs,health:ro,lifespan:ra,z:iW,move:i_,offscreen:i$,follow:iZ,state:rh,fadeIn:rl,mask:ru,drawon:rd,tile:rv,agent:rx,on:iR,onUpdate:iM,onDraw:iT,onAdd:iP,onDestroy:iB,onClick:iC,onCollide:ik,onCollideUpdate:iF,onCollideEnd:iI,onHover:iU,onHoverUpdate:iN,onHoverEnd:iL,onKeyDown:eM.onKeyDown,onKeyPress:eM.onKeyPress,onKeyPressRepeat:eM.onKeyPressRepeat,onKeyRelease:eM.onKeyRelease,onMouseDown:eM.onMouseDown,onMousePress:eM.onMousePress,onMouseRelease:eM.onMouseRelease,onMouseMove:eM.onMouseMove,onCharInput:eM.onCharInput,onTouchStart:eM.onTouchStart,onTouchMove:eM.onTouchMove,onTouchEnd:eM.onTouchEnd,onScroll:eM.onScroll,onHide:eM.onHide,onShow:eM.onShow,onGamepadButtonDown:eM.onGamepadButtonDown,onGamepadButtonPress:eM.onGamepadButtonPress,onGamepadButtonRelease:eM.onGamepadButtonRelease,onGamepadStick:eM.onGamepadStick,mousePos:ip,mouseDeltaPos:eM.mouseDeltaPos,isKeyDown:eM.isKeyDown,isKeyPressed:eM.isKeyPressed,isKeyPressedRepeat:eM.isKeyPressedRepeat,isKeyReleased:eM.isKeyReleased,isMouseDown:eM.isMouseDown,isMousePressed:eM.isMousePressed,isMouseReleased:eM.isMouseReleased,isMouseMoved:eM.isMouseMoved,isGamepadButtonPressed:eM.isGamepadButtonPressed,isGamepadButtonDown:eM.isGamepadButtonDown,isGamepadButtonReleased:eM.isGamepadButtonReleased,getGamepadStick:eM.getGamepadStick,charInputted:eM.charInputted,loop:rk,wait:rB,play:tF,volume:tk,burp:tI,audioCtx:eQ.ctx,Line:Y,Rect:Q,Circle:z,Polygon:X,Vec2:w,Color:y,Mat4:S,Quad:x,RNG:T,rand:k,randi:F,randSeed:B,vec2:A,rgb:v,hsl2rgb:V,quad:E,choose:D,chance:I,lerp:f,tween:rF,easings:eJ,map:g,mapc:m,wave:R,deg2rad:l,rad2deg:u,clamp:c,testLineLine:N,testRectRect:C,testRectLine:L,testRectPoint:O,testCirclePolygon:K,testLinePoint:G,testLineCircle:q,drawSprite:tZ,drawText:ia,formatText:io,drawRect:t$,drawLine:t0,drawLines:t1,drawTriangle:t2,drawCircle:t5,drawEllipse:t4,drawUVQuad:tX,drawPolygon:t6,drawFormattedText:ih,drawMasked:t3,drawSubtracted:t9,pushTransform:tz,popTransform:tJ,pushTranslate:tj,pushScale:tY,pushRotate:tQ,pushMatrix:tK,usePostEffect:tG,makeCanvas:tD,debug:im,scene:rf,go:rp,onSceneLeave:rg,addLevel:rV,getData:rm,setData:rw,download:en,downloadJSON:eo,downloadText:es,downloadBlob:ea,plug:rA,ASCII_CHARS:eZ,canvas:eM.canvas,addKaboom:rU,LEFT:w.LEFT,RIGHT:w.RIGHT,UP:w.UP,DOWN:w.DOWN,RED:y.RED,GREEN:y.GREEN,BLUE:y.BLUE,YELLOW:y.YELLOW,MAGENTA:y.MAGENTA,CYAN:y.CYAN,WHITE:y.WHITE,BLACK:y.BLACK,quit:rX,Event:$,EventHandler:ee,EventController:_};if(e.plugins&&e.plugins.forEach(rA),!1!==e.global)for(let e in r$)window[e]=r$[e];return!1!==e.focus&&eM.canvas.focus(),r$},"default")({global:!1,touchToMouse:!0,canvas:document.getElementById("game"),debug:!1});function tr(e){e.width()/e.height()<1?e.camScale(e.vec2(1)):e.camScale(e.vec2(1.5))}ti.loadSprite("spritesheet","./spritesheet.png",{sliceX:39,sliceY:31,anims:{"idle-down":964,"walk-down":{from:964,to:967,loop:!0,speed:8},"idle-side":1003,"walk-side":{from:1003,to:1006,loop:!0,speed:8},"idle-up":1042,"walk-up":{from:1042,to:1045,loop:!0,speed:8}}}),ti.loadSprite("map","./map.png"),ti.setBackground(ti.Color.fromHex("#311047")),ti.scene("main",async()=>{let e=(await (await fetch("./map.json")).json()).layers,r=ti.add([ti.sprite("map"),ti.pos(0),ti.scale(4)]),n=ti.make([ti.sprite("spritesheet",{anim:"idle-down"}),ti.area({shape:new ti.Rect(ti.vec2(0,3),10,10)}),ti.body(),ti.anchor("center"),ti.pos(),ti.scale(4),{speed:250,direction:"down",isInDialogue:!1},"player"]);for(let o of e){if("boundaries"===o.name){for(let e of o.objects)r.add([ti.area({shape:new ti.Rect(ti.vec2(0),e.width,e.height)}),ti.body({isStatic:!0}),ti.pos(e.x,e.y),e.name]),e.name&&n.onCollide(e.name,()=>{n.isInDialogue=!0,function(e,i){let r=document.getElementById("textbox-container"),n=document.getElementById("dialogue");r.style.display="block";let o=0,l="",u=setInterval(()=>{if(o<e.length){l+=e[o],n.innerHTML=l,o++;return}clearInterval(u)},1),c=document.getElementById("close");c.addEventListener("click",function e(){i(),r.style.display="none",n.innerHTML="",clearInterval(u),c.removeEventListener("click",e)}),addEventListener("keypress",e=>{"Enter"===e.code&&c.click()})}(i[e.name],()=>n.isInDialogue=!1)});continue}if("spawnpoints"===o.name){for(let e of o.objects)if("player"===e.name){n.pos=ti.vec2((r.pos.x+e.x)*4,(r.pos.y+e.y)*4),ti.add(n);continue}}}function o(){if("down"===n.direction){n.play("idle-down");return}if("up"===n.direction){n.play("idle-up");return}n.play("idle-side")}tr(ti),ti.onResize(()=>{tr(ti)}),ti.onUpdate(()=>{ti.camPos(n.worldPos().x,n.worldPos().y-100)}),ti.onMouseDown(e=>{if("left"!==e||n.isInDialogue)return;let i=ti.toWorld(ti.mousePos());n.moveTo(i,n.speed);let r=n.pos.angle(i);if(r>50&&r<125&&"walk-up"!==n.curAnim()){n.play("walk-up"),n.direction="up";return}if(r<-50&&r>-125&&"walk-down"!==n.curAnim()){n.play("walk-down"),n.direction="down";return}if(Math.abs(r)>125){n.flipX=!1,"walk-side"!==n.curAnim()&&n.play("walk-side"),n.direction="right";return}if(50>Math.abs(r)){n.flipX=!0,"walk-side"!==n.curAnim()&&n.play("walk-side"),n.direction="left";return}}),ti.onMouseRelease(o),ti.onKeyRelease(()=>{o()}),ti.onKeyDown(e=>{let i=[ti.isKeyDown("right"),ti.isKeyDown("left"),ti.isKeyDown("up"),ti.isKeyDown("down")],r=0;for(let e of i)e&&r++;if(!(r>1)&&!n.isInDialogue){if(i[0]){n.flipX=!1,"walk-side"!==n.curAnim()&&n.play("walk-side"),n.direction="right",n.move(n.speed,0);return}if(i[1]){n.flipX=!0,"walk-side"!==n.curAnim()&&n.play("walk-side"),n.direction="left",n.move(-n.speed,0);return}if(i[2]){"walk-up"!==n.curAnim()&&n.play("walk-up"),n.direction="up",n.move(0,-n.speed);return}i[3]&&("walk-down"!==n.curAnim()&&n.play("walk-down"),n.direction="down",n.move(0,n.speed))}})}),ti.go("main");
//# sourceMappingURL=index.b5029828.js.map
